<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="1. 计算机网络与因特网1.1 什么是Internet因特网是一个世界范围的计算机网络，即它是一个互联了遍及全球数十亿计算设备的网络 –》是一堆网络通过网络互联设备连接成的大网络（所有网络中的一种）  计算机网络：两台以上具有独立操作系统的计算机通过某些介质连接成的相互共享软硬件资源的集合体。 计算设备用因特网术语来说，所有这些设备都成为主机或端系统。 端系统通过通信链路和分组交换机连接到一起。">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络">
<meta property="og:url" content="http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/index.html">
<meta property="og:site_name" content="psych&#39;s blog">
<meta property="og:description" content="1. 计算机网络与因特网1.1 什么是Internet因特网是一个世界范围的计算机网络，即它是一个互联了遍及全球数十亿计算设备的网络 –》是一堆网络通过网络互联设备连接成的大网络（所有网络中的一种）  计算机网络：两台以上具有独立操作系统的计算机通过某些介质连接成的相互共享软硬件资源的集合体。 计算设备用因特网术语来说，所有这些设备都成为主机或端系统。 端系统通过通信链路和分组交换机连接到一起。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20221031210610129.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20221101001825924.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240604171256657.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240604193412884.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240604195448084.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20231013174016038.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614212356037.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614213059106.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614213124008.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614215542592.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614214233257.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/114bd9b53c554319ae0db15b57b472b8.gif#pic_center">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614215033238.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/0c17d72769aa4bd2b95bbaee1749b39d.gif#pic_center">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614215054178.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614220017156.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616002021305.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616000314784.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616021457439.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616021507807.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616024328288.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240617101903565.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20231017133434632.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20231017133540916.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240617203834409.png">
<meta property="article:published_time" content="2024-06-17T12:45:25.000Z">
<meta property="article:modified_time" content="2024-06-17T12:46:11.230Z">
<meta property="article:author" content="psych">
<meta property="article:tag" content="课内">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20221031210610129.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>计算机网络</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="psych&#39;s blog" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Article</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/09/25/python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/05/24/%E6%A8%A1%E7%B3%8A%E4%B8%96%E7%95%8C/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&text=计算机网络"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&is_video=false&description=计算机网络"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=计算机网络&body=Check out this article: http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&name=计算机网络&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&t=计算机网络"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%9B%A0%E7%89%B9%E7%BD%91"><span class="toc-number">1.</span> <span class="toc-text">1. 计算机网络与因特网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AFInternet"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 什么是Internet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E8%AE%BE%E5%A4%87"><span class="toc-number">1.1.1.</span> <span class="toc-text">计算设备</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E9%93%BE%E8%B7%AF"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">通信链路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">分组交换机</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="toc-number">1.1.1.2.1.</span> <span class="toc-text">路由器</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">1.1.1.2.2.</span> <span class="toc-text">链路层交换机</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.1.3.</span> <span class="toc-text">服务描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE-1"><span class="toc-number">1.1.4.</span> <span class="toc-text">协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E7%BD%91%E7%BB%9C%E8%BE%B9%E7%BC%98"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 网络边缘</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%BF%9B%E7%A8%8B%E4%B9%8B%E9%97%B4%E9%80%9A%E8%AE%AF%E6%A8%A1%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.2.0.0.1.</span> <span class="toc-text">应用进程之间通讯模式：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BE%B9%E7%BC%98%EF%BC%9A%E9%87%87%E7%94%A8%E7%BD%91%E7%BB%9C%E8%AE%BE%E6%96%BD%E7%9A%84%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.0.0.2.</span> <span class="toc-text">网络边缘：采用网络设施的面向连接服务</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83"><span class="toc-number">1.3.</span> <span class="toc-text">1.3网络核心</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">电路交换</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E5%A4%8D%E7%94%A8"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">电路交换网络中的复用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#FDM"><span class="toc-number">1.3.1.1.1.</span> <span class="toc-text">FDM</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TDM"><span class="toc-number">1.3.1.1.2.</span> <span class="toc-text">TDM</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%80%E9%99%90%E6%80%A7"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">局限性</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2"><span class="toc-number">1.3.2.</span> <span class="toc-text">分组交换</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BD%AC%E5%8F%91%E4%BC%A0%E8%BE%93"><span class="toc-number">1.3.2.0.1.</span> <span class="toc-text">存储转发传输</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB"><span class="toc-number">1.3.3.</span> <span class="toc-text">网络分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4%E6%8E%A5%E5%85%A5%E7%BD%91%E5%92%8C%E7%89%A9%E7%90%86%E5%AA%92%E4%BD%93"><span class="toc-number">1.4.</span> <span class="toc-text">1.4接入网和物理媒体</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5%E7%BD%91%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.4.1.</span> <span class="toc-text">接入网类型和环境</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%B6%E5%BA%AD%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">家庭接入</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#DSL%E5%9B%A0%E7%89%B9%E7%BD%91%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.1.1.</span> <span class="toc-text">DSL因特网接入</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%B5%E7%BC%86%E5%9B%A0%E7%89%B9%E7%BD%91%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.1.2.</span> <span class="toc-text">电缆因特网接入</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%89%E7%BA%A4%E5%88%B0%E6%88%B7%EF%BC%88FTTH%EF%BC%89"><span class="toc-number">1.4.1.1.3.</span> <span class="toc-text">光纤到户（FTTH）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8B%A8%E5%8F%B7%E5%92%8C%E5%8D%AB%E6%98%9F"><span class="toc-number">1.4.1.1.4.</span> <span class="toc-text">拨号和卫星</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">企业接入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B9%BF%E5%9F%9F%E6%97%A0%E7%BA%BF%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">广域无线接入</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%AA%92%E4%BD%93"><span class="toc-number">1.4.2.</span> <span class="toc-text">物理媒体</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7%E5%8D%8F%E8%AE%AE%E5%B1%82%E6%AC%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.5.</span> <span class="toc-text">1.7协议层次和服务模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.5.1.</span> <span class="toc-text">协议和服务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E5%8C%96%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E5%8A%9F%E8%83%BD%EF%BC%9A"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">层次化方式实现复杂网络功能：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE%E7%82%B9"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">服务和服务访问点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E6%A0%88"><span class="toc-number">1.5.2.</span> <span class="toc-text">协议栈</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8"><span class="toc-number">1.5.2.0.1.</span> <span class="toc-text">应用层：网络应用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%9A%E4%B8%BB%E6%9C%BA%E4%B9%8B%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="toc-number">1.5.2.0.2.</span> <span class="toc-text">传输层：主机之间的数据传输</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9A%E4%B8%BA%E6%95%B0%E6%8D%AE%E6%8A%A5%E4%BB%8E%E6%BA%90%E5%88%B0%E7%9B%AE%E7%9A%84%E7%9A%84%E9%80%89%E6%8B%A9%E8%B7%AF%E7%94%B1"><span class="toc-number">1.5.2.0.3.</span> <span class="toc-text">网络层：为数据报从源到目的的选择路由</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%9A%E7%9B%B8%E9%82%BB%E7%BD%91%E7%BB%9C%E8%8A%82%E7%82%B9-%E7%BD%91%E5%8D%A1-%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="toc-number">1.5.2.0.4.</span> <span class="toc-text">链路层：相邻网络节点[网卡?]间的数据传输</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82%EF%BC%9A%E5%9C%A8%E7%BA%BF%E8%B7%AF%E4%B8%8A%E4%BC%A0%E9%80%81bit"><span class="toc-number">1.5.2.0.5.</span> <span class="toc-text">物理层：在线路上传送bit</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ISO-OSI%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.5.3.</span> <span class="toc-text">ISO&#x2F;OSI参考模型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%A1%A8%E7%A4%BA%E5%B1%82"><span class="toc-number">1.5.3.0.1.</span> <span class="toc-text">表示层</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%9A%E8%AF%9D%E5%B1%82%EF%BC%9A"><span class="toc-number">1.5.3.0.2.</span> <span class="toc-text">会话层：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%84%E4%B8%AA%E5%B1%82%E6%AC%A1%E7%9A%84%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83"><span class="toc-number">1.5.4.</span> <span class="toc-text">各个层次的协议数据单元</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">2.</span> <span class="toc-text">2.应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84"><span class="toc-number">2.1.</span> <span class="toc-text">网络应用程序体系架构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7-%E6%9C%8D%E5%8A%A1%E5%99%A8-C-S-%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">客户-服务器(C&#x2F;S)体系架构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%B9%E7%AD%89%E4%BD%93-P2P-%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.0.2.</span> <span class="toc-text">对等体(P2P)体系结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C-S%E5%92%8CP2Peye-com%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E7%9A%84%E6%B7%B7%E5%90%88%E4%BD%93"><span class="toc-number">2.1.0.3.</span> <span class="toc-text">C&#x2F;S和P2Peye.com体系结构的混合体</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Napster"><span class="toc-number">2.1.0.3.1.</span> <span class="toc-text">Napster</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8D%B3%E6%97%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">2.1.0.3.2.</span> <span class="toc-text">即时通信</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1"><span class="toc-number">2.2.</span> <span class="toc-text">进程通信</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E5%85%A8TCP%E2%80%94%E2%80%94SSL"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">安全TCP——SSL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP"><span class="toc-number">2.3.</span> <span class="toc-text">HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E6%A6%82%E5%86%B5"><span class="toc-number">2.3.0.0.1.</span> <span class="toc-text">HTTP概况</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.3.0.0.2.</span> <span class="toc-text">HTTP连接</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87"><span class="toc-number">2.3.0.0.3.</span> <span class="toc-text">HTTP请求报文</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87"><span class="toc-number">2.3.0.0.4.</span> <span class="toc-text">HTTP响应报文</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FTP"><span class="toc-number">2.4.</span> <span class="toc-text">FTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.4.0.1.</span> <span class="toc-text">主动模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A2%AB%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.4.0.2.</span> <span class="toc-text">被动模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SMTP"><span class="toc-number">2.5.</span> <span class="toc-text">SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#SMTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.5.0.0.1.</span> <span class="toc-text">SMTP协议</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS"><span class="toc-number">2.6.</span> <span class="toc-text">DNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="toc-number">3.</span> <span class="toc-text">3.传输层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">3.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%8F%B7%E3%80%81%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%88%86%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">端口号、复用与分用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">3.2.1.</span> <span class="toc-text">端口号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E7%94%A8%E5%92%8C%E5%88%86%E7%94%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">复用和分用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-%E4%B8%8E-UDP"><span class="toc-number">3.3.</span> <span class="toc-text">TCP 与 UDP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E9%83%A8"><span class="toc-number">3.3.1.</span> <span class="toc-text">首部</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#UDP"><span class="toc-number">3.3.1.0.1.</span> <span class="toc-text">UDP</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TCP"><span class="toc-number">3.3.1.0.2.</span> <span class="toc-text">TCP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94"><span class="toc-number">3.3.2.</span> <span class="toc-text">对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">3.4.</span> <span class="toc-text">TCP实现原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">3.4.1.</span> <span class="toc-text">流量控制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E6%9C%BA%E5%88%B6"><span class="toc-number">3.4.1.1.</span> <span class="toc-text">滑动窗口机制</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6"><span class="toc-number">3.4.2.</span> <span class="toc-text">拥塞控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B"><span class="toc-number">3.4.3.</span> <span class="toc-text">三次握手四次挥手</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8F%A1%E6%89%8B"><span class="toc-number">3.4.3.1.</span> <span class="toc-text">握手</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%A5%E6%89%8B"><span class="toc-number">3.4.3.2.</span> <span class="toc-text">挥手</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">4.</span> <span class="toc-text">4. 网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">4.1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2%E5%92%8C%E6%8E%A7%E5%88%B6%E5%B9%B3%E9%9D%A2"><span class="toc-number">4.1.1.</span> <span class="toc-text">数据平面和控制平面</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPV4"><span class="toc-number">4.2.</span> <span class="toc-text">IPV4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%9D%80"><span class="toc-number">4.2.1.</span> <span class="toc-text">编址</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">分类编址</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">划分子网</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8F%91%E9%80%81"><span class="toc-number">4.2.2.</span> <span class="toc-text">数据报发送</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%8F%91%E9%80%81-IP-%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">主机发送 IP 数据报</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E8%BD%AC%E5%8F%91-IP-%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">路由器转发 IP 数据报</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.2.3.</span> <span class="toc-text">数据报格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.</span> <span class="toc-text">路由选择协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RIP-%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.1.</span> <span class="toc-text">RIP - 路由信息协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OSPF-%E5%BC%80%E6%94%BE%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88"><span class="toc-number">4.3.2.</span> <span class="toc-text">OSPF - 开放最短路径优先</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BGP-%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.3.</span> <span class="toc-text">BGP - 边界网关协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP-%E4%BA%92%E8%81%94%E7%BD%91%E6%8E%A7%E5%88%B6%E6%B6%88%E6%81%AF%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.4.</span> <span class="toc-text">ICMP - 互联网控制消息协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">4.4.1.</span> <span class="toc-text">应用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DHCP-%E5%8A%A8%E6%80%81%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.5.</span> <span class="toc-text">DHCP - 动态主机配置协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NAT-%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">4.6.</span> <span class="toc-text">NAT - 网络地址转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.6.1.</span> <span class="toc-text">类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NAT-%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.6.2.</span> <span class="toc-text">NAT 的类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SDN-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="toc-number">4.7.</span> <span class="toc-text">SDN - 软件定义网络</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.7.1.</span> <span class="toc-text">工作原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">5.</span> <span class="toc-text">5. 数据链路层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">5.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E6%88%90%E5%B8%A7"><span class="toc-number">5.2.</span> <span class="toc-text">封装成帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B"><span class="toc-number">5.3.</span> <span class="toc-text">差错检测</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CRC-%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A3%80%E6%B5%8B"><span class="toc-number">5.3.1.</span> <span class="toc-text">CRC - 循环冗余检测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.4.</span> <span class="toc-text">多路访问协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#FDM-%E9%A2%91%E5%88%86%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">5.4.1.</span> <span class="toc-text">FDM - 频分多路复用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TDM-%E6%97%B6%E5%88%86%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">5.4.2.</span> <span class="toc-text">TDM - 时分多路复用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CDM-%E7%A0%81%E5%88%86%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">5.4.3.</span> <span class="toc-text">CDM - 码分多路复用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSMA-%E8%BD%BD%E6%B3%A2%E4%BE%A6%E5%90%AC%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE"><span class="toc-number">5.4.4.</span> <span class="toc-text">CSMA - 载波侦听多路访问</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CD%EF%BC%88%E5%B8%A6%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B%E7%9A%84-CSMA%EF%BC%89"><span class="toc-number">5.4.4.1.</span> <span class="toc-text">CSMA&#x2F;CD（带碰撞检测的 CSMA）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CA%EF%BC%88%E5%B8%A6%E7%A2%B0%E6%92%9E%E9%81%BF%E5%85%8D%E7%9A%84-CSMA%EF%BC%89"><span class="toc-number">5.4.4.2.</span> <span class="toc-text">CSMA&#x2F;CA（带碰撞避免的 CSMA）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ARP-%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.5.</span> <span class="toc-text">ARP - 地址解析协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86-1"><span class="toc-number">5.5.1.</span> <span class="toc-text">工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.5.2.</span> <span class="toc-text">消息格式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%BC%96%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text">6. 套接字编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%8D%8F%E8%AE%AE"><span class="toc-number">6.1.</span> <span class="toc-text">接口协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Socket-%E7%BC%96%E7%A8%8B"><span class="toc-number">6.2.</span> <span class="toc-text">Socket 编程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.2.1.</span> <span class="toc-text">服务器端步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.2.2.</span> <span class="toc-text">客户端步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TCP-%E7%BC%96%E7%A8%8B"><span class="toc-number">6.2.3.</span> <span class="toc-text">TCP 编程</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84socketaddr-in"><span class="toc-number">6.2.3.0.1.</span> <span class="toc-text">数据结构socketaddr_in</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%EF%BC%9ATCP-%E7%BC%96%E7%A8%8B-%E4%BA%94%E5%88%99%E8%BF%90%E7%AE%97"><span class="toc-number">7.</span> <span class="toc-text">实验：TCP 编程 - 五则运算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="toc-number">7.0.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#server-%E7%AB%AF%E4%BB%A3%E7%A0%81"><span class="toc-number">7.0.2.</span> <span class="toc-text">server 端代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#client-%E7%AB%AF%E4%BB%A3%E7%A0%81"><span class="toc-number">7.0.3.</span> <span class="toc-text">client 端代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">7.0.4.</span> <span class="toc-text">注意事项</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        计算机网络
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">psych</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-06-17T12:45:25.000Z" class="dt-published" itemprop="datePublished">2024-06-17</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E8%AF%BE%E5%86%85/">课内</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/%E8%AF%BE%E5%86%85/" rel="tag">课内</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="1-计算机网络与因特网"><a href="#1-计算机网络与因特网" class="headerlink" title="1. 计算机网络与因特网"></a>1. 计算机网络与因特网</h2><h3 id="1-1-什么是Internet"><a href="#1-1-什么是Internet" class="headerlink" title="1.1 什么是Internet"></a>1.1 什么是Internet</h3><p>因特网是一个世界范围的计算机网络，即它是一个互联了遍及全球数十亿<strong>计算设备</strong>的网络</p>
<p>–》是一堆网络通过网络互联设备连接成的大网络（所有网络中的一种）</p>
<hr>
<p><strong>计算机网络</strong>：两台以上具有独立操作系统的计算机通过某些介质连接<br>成的相互共享软硬件资源的集合体。</p>
<h4 id="计算设备"><a href="#计算设备" class="headerlink" title="计算设备"></a>计算设备</h4><p>用因特网术语来说，所有这些设备都成为<strong>主机</strong>或<strong>端系统</strong>。</p>
<p><strong>端系统</strong>通过<strong>通信链路</strong>和<strong>分组交换机</strong>连接到一起。</p>
<h5 id="通信链路"><a href="#通信链路" class="headerlink" title="通信链路"></a>通信链路</h5><p>不同类型的通信链路由不同类型的物理媒体组成（电缆，铜线，光纤，无线电频谱）。不同链路以不同传输速度传输数据。当一台端系统向另一台端系统发送数据时，发送端系统将数据分段，并为每段加上首部字节，形成的信息包用计算机网络的术语来说叫<strong>分组</strong>。分组通过网络发送到目的端系统，在哪里被装配成初始数据。</p>
<h5 id="分组交换机"><a href="#分组交换机" class="headerlink" title="分组交换机"></a>分组交换机</h5><p>分组交换机从它的一条入通信链路接受到达的分组，并从它的一条出通信链路转发该分组。</p>
<p>分组交换机最著名的两种是：<strong>路由器</strong>和<strong>链路层交换机</strong></p>
<h6 id="路由器"><a href="#路由器" class="headerlink" title="路由器"></a>路由器</h6><ul>
<li>通常用于网络核心中</li>
</ul>
<h6 id="链路层交换机"><a href="#链路层交换机" class="headerlink" title="链路层交换机"></a>链路层交换机</h6><ul>
<li>通常用于接入网中。交换机主要在数据链路层工作。</li>
</ul>
<h4 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h4><p>端系统，分组交换机和其他因特网部件都要运行一系列协议，这些协议控制新特王中信息的接收和发送。TCP&#x2F;IP协议是因特网中最为重要的两个协议。</p>
<p>因特网的主要协议统称为tcp&#x2F;ip协议。</p>
<h4 id="服务描述"><a href="#服务描述" class="headerlink" title="服务描述"></a>服务描述</h4><p>我们从”<strong>为应用提供服务的基础设施</strong>“的角度来描述因特网。一些在线社交网络，视频会议，以及基于位置的推荐系统等，这些应用程序<strong>涉及多个相互交换数据的端系统</strong>，故他们被称为<strong>分布式应用程序</strong>。</p>
<p>重要的是，因特网应用程序<strong>运行在端系统上</strong>，即他们并不运行在网络核心中的分组交换机中。</p>
<p>与因特网相连的端系统提供了一个套接字借口，该接口规定了运行在一个端系统上的程序请求因特网基础设施向运行在另一个端系统上的特定目的程序<strong>交付数据</strong>的方式。</p>
<p><strong>因特网套接字接口</strong>是一套发送程序必须遵守的规则集合。</p>
<h4 id="协议-1"><a href="#协议-1" class="headerlink" title="协议"></a>协议</h4><p>协议定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文发送和&#x2F;或接收一条报文或为他事务所采取的动作。</p>
<p><strong>掌握计算结网络领域知识的过程就是理解网络协议的构成，原理和工作方式的过程。</strong></p>
<h3 id="1-2-网络边缘"><a href="#1-2-网络边缘" class="headerlink" title="1.2 网络边缘"></a>1.2 网络边缘</h3><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20221031210610129.png" alt="image-20221031210610129" style="zoom:33%;" />

<p>网络核心作用：数据交换(全球范围内切换开关，达到瞬时的连接，进行数据交换)(分布式系统相互配合)</p>
<p>接入：把网络边缘接入到网络核心</p>
<p>网络边缘：有网络应用，是网络存在的理由</p>
<h6 id="应用进程之间通讯模式："><a href="#应用进程之间通讯模式：" class="headerlink" title="应用进程之间通讯模式："></a>应用进程之间通讯模式：</h6><p>1.CS模式（客户端-服务端模式）—-扩展性差（请求响应达到一定程度，会崩）</p>
<p>2.对等模式（peer-peer[p2p]）—-某些节点即是客户端也是服务端。   扩展性强（迅雷）</p>
<h6 id="网络边缘：采用网络设施的面向连接服务"><a href="#网络边缘：采用网络设施的面向连接服务" class="headerlink" title="网络边缘：采用网络设施的面向连接服务"></a>网络边缘：采用网络设施的面向连接服务</h6><p>面向连接：两方主机在会话前做好准备，即为连接建立状态。（两端主机知道但是中间的网络不知道）</p>
<p><strong>TCP服务</strong>：可靠的按顺序地传输数据</p>
<p><strong>UDP服务</strong>：无连接服务，不可靠，但及时</p>
<h3 id="1-3网络核心"><a href="#1-3网络核心" class="headerlink" title="1.3网络核心"></a>1.3网络核心</h3><h4 id="电路交换"><a href="#电路交换" class="headerlink" title="电路交换"></a>电路交换</h4><p>电路交换网络中，端系统见通信会话期间，<strong>预留</strong>了端系统见沿路通信所需要的资源（缓存，链路传输速率）（分组交换中不可预留）   —-性能保障</p>
<h5 id="电路交换网络中的复用"><a href="#电路交换网络中的复用" class="headerlink" title="电路交换网络中的复用"></a>电路交换网络中的复用</h5><p>链路中的电路是通过频分复用（FDM）或时分复用（TDM）来实现。</p>
<h6 id="FDM"><a href="#FDM" class="headerlink" title="FDM"></a>FDM</h6><p>链路的频谱由跨越链路创建的所有连接共享。在连接期间链路为每条连接专用一个频段，该频段的宽度成为<strong>带宽</strong>。</p>
<h6 id="TDM"><a href="#TDM" class="headerlink" title="TDM"></a>TDM</h6><p>时间被划分成固定期间的帧，并且每个帧又被划分为固定数量的时隙。创建一条连接时，网络在每个帧中为该连接指定一个时隙，这些<strong>时隙</strong>专门 由该连接单独使用。</p>
<h5 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h5><p>电路交换不适合计算机之间的通信：</p>
<p>1.连接建立时间长</p>
<p>2.计算机之间的通信有突发性，如果使用线路交换，则浪费的片较多</p>
<p>3.可靠性不高</p>
<h4 id="分组交换"><a href="#分组交换" class="headerlink" title="分组交换"></a>分组交换</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在源和目的地之间，每个分组都通过通信链路和分组交换机传送。</span><br><span class="line">（交换机主要有两类：路由器，链路层交换机）</span><br><span class="line">分组以等于该链路最大传输速率的速度通过通信链路。</span><br></pre></td></tr></table></figure>

<h6 id="存储转发传输"><a href="#存储转发传输" class="headerlink" title="存储转发传输"></a>存储转发传输</h6><p>多数分组交换机在链路的输入的输入端使用<strong>存储转发传输</strong>机制</p>
<p>指在交换机能够开始向输出链路传输该分组的第一个比特之前，必须接收到整个分组。</p>
<p>—-更适用于突发请求的情况</p>
<h4 id="网络分类"><a href="#网络分类" class="headerlink" title="网络分类"></a>网络分类</h4><p><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20221101001825924.png" alt="image-20221101001825924"></p>
<h3 id="1-4接入网和物理媒体"><a href="#1-4接入网和物理媒体" class="headerlink" title="1.4接入网和物理媒体"></a>1.4接入网和物理媒体</h3><p>这里接入网指<strong>将端系统物理连接到边缘路由器的网络</strong>。<strong>边缘路由器</strong>是端系统到任何其他远程端系统的路径上第一台路由器。</p>
<h4 id="接入网类型和环境"><a href="#接入网类型和环境" class="headerlink" title="接入网类型和环境"></a>接入网类型和环境</h4><h5 id="家庭接入"><a href="#家庭接入" class="headerlink" title="家庭接入"></a>家庭接入</h5><p><strong>DSL,电缆，FTTH，拨号和卫星</strong></p>
<p>宽带住宅接入有两种流行的类型：<strong>数字用户线（DSL）</strong>和<strong>电缆</strong></p>
<h6 id="DSL因特网接入"><a href="#DSL因特网接入" class="headerlink" title="DSL因特网接入"></a>DSL因特网接入</h6><p>DSL利用现成的本地电话基础设施。</p>
<p>用户从提供本地电话接入的本地电话公司处获得DSL因特网接入。每个用户的DSL调制解调器使用现成的电话线与位于电话公司的本地中心局的数字用户线接入复用器（DSLAM）交换数据。</p>
<h6 id="电缆因特网接入"><a href="#电缆因特网接入" class="headerlink" title="电缆因特网接入"></a>电缆因特网接入</h6><p>电缆因特网接入利用了有线电视公司现有的有线电视基础设施。</p>
<p>住宅从提供有线电视的公司获得了电缆因特网接入，光缆将电缆头端连接到地区枢纽，从这里使用传统的同轴电缆到达各家各户和公寓。</p>
<p><strong>modem</strong></p>
<p>电缆因特网接入需要特殊的调制解调器，称为<strong>电缆调制解调器</strong>（cable modem）。如同DSL调制解调器，电缆调制解调器是一种外部设备，通过以太网端口连接到家庭pc</p>
<h6 id="光纤到户（FTTH）"><a href="#光纤到户（FTTH）" class="headerlink" title="光纤到户（FTTH）"></a>光纤到户（FTTH）</h6><p>从本地中心局到直接到家庭提供了一根光纤路径。</p>
<h6 id="拨号和卫星"><a href="#拨号和卫星" class="headerlink" title="拨号和卫星"></a>拨号和卫星</h6><p>在某些乡村环境，无法提供DSL，电缆和FTTH的情况下，能够使用卫星链路将住宅以超过1Mbps的速率与因特网相连。使用传统电话线的拨号接入与DSL基于相同的模式：家庭的调节解调器经过电话线连接到ISP的调节解调器。</p>
<h5 id="企业接入"><a href="#企业接入" class="headerlink" title="企业接入"></a>企业接入</h5><p><strong>以太网和WiFi</strong></p>
<p>公司，学校和越来越多的家庭，使用<strong>局域网（LAN）</strong>将端系统连接到边缘路由器。尽管有不同类型的局域网技术，<strong>以太网</strong>是目前为止最受欢迎的接入技术。</p>
<p>以太网用户使用<strong>双绞铜线与一台以太网交换机相连</strong>。（有线）</p>
<p>然而越来越多的人从其他物品<strong>无线接入</strong>因特网。一个无线LAN用户通常必须位于接入点的几十米范围内。基于IEEE 802.11技术的无线LAN接入，通俗点说就是<strong>WiFi</strong>，目前几乎无处不在。（无线）</p>
<h5 id="广域无线接入"><a href="#广域无线接入" class="headerlink" title="广域无线接入"></a>广域无线接入</h5><p><strong>5G和LTE</strong>（dd）</p>
<p>iphone和安卓等设备越来越多的用来在移动中发送信息。这些设备应用了与蜂窝移动电话相同的无线基础设施，通过<strong>蜂窝网</strong>提供商运营的基站来发送和接收分组。与WiFi不同的是，用户需要位于基站的<strong>数万米</strong>范围内。</p>
<h4 id="物理媒体"><a href="#物理媒体" class="headerlink" title="物理媒体"></a>物理媒体</h4><p>物理媒体的例子包括：双绞铜线（以太网），同轴铜线（HFC），多模光纤缆，陆地无线电频谱和卫星无线电频谱。</p>
<p>物理媒体分为：<strong>异引型媒体</strong>和<strong>非异引型媒体</strong></p>
<h3 id="1-7协议层次和服务模型"><a href="#1-7协议层次和服务模型" class="headerlink" title="1.7协议层次和服务模型"></a>1.7协议层次和服务模型</h3><h4 id="协议和服务"><a href="#协议和服务" class="headerlink" title="协议和服务"></a>协议和服务</h4><h5 id="层次化方式实现复杂网络功能："><a href="#层次化方式实现复杂网络功能：" class="headerlink" title="层次化方式实现复杂网络功能："></a>层次化方式实现复杂网络功能：</h5><ul>
<li>将网络复杂的功能分层功能明确的层次，每一层实现了其中一个或一组功能，功能中有其上层可以使用的功能：服务</li>
<li>本层协议实体相互交互执行本层的协议动作，目的是实现本层功能，通过接口为上层提供更好的服务</li>
<li>在实现本层协议的时候，直接利用了下层所提供的服务</li>
<li>本层的服务：借助下层服务实现的本层协议实体之间交互带来的新功能(上层可以利用的)+更下层提供的服务</li>
</ul>
<p><strong>协议的目的是为了给上层提供更好的服务。</strong></p>
<h5 id="服务和服务访问点"><a href="#服务和服务访问点" class="headerlink" title="服务和服务访问点"></a>服务和服务访问点</h5><p>**服务(service)**：低层向上层实体提供它们之间的通信的能力</p>
<ul>
<li>服务用户(service user)</li>
<li>服务提供者(service provider)</li>
</ul>
<p>**服务访问点 SAP(Service Access Point)**：上层使用下层提供的服务时通过层间的接口地点，例如port</p>
<blockquote>
<p><strong>总结：本层协议的实现需要借助下层提供的服务，而本层协议实现的目的是为了向上层提供服务</strong></p>
</blockquote>
<h4 id="协议栈"><a href="#协议栈" class="headerlink" title="协议栈"></a>协议栈</h4><h6 id="应用层：网络应用"><a href="#应用层：网络应用" class="headerlink" title="应用层：网络应用"></a>应用层：网络应用</h6><ul>
<li>为人类用户或者其他应用进程提供网络应用服务</li>
<li>FTP，SMTP，HTTP，DNS</li>
</ul>
<h6 id="传输层：主机之间的数据传输"><a href="#传输层：主机之间的数据传输" class="headerlink" title="传输层：主机之间的数据传输"></a>传输层：主机之间的数据传输</h6><ul>
<li>在网络层提供的端到端的通信基础上，细分为进程到进程	    ——<strong>进程到进程</strong></li>
<li>将不可靠的通信变成可靠通信</li>
<li>TCP,UDP</li>
</ul>
<h6 id="网络层：为数据报从源到目的的选择路由"><a href="#网络层：为数据报从源到目的的选择路由" class="headerlink" title="网络层：为数据报从源到目的的选择路由"></a>网络层：为数据报从源到目的的选择路由</h6><ul>
<li>主机主机之间的通信，端到端通信，不可靠        					     ——<strong>端到端</strong></li>
<li>IP，路由协议</li>
</ul>
<h6 id="链路层：相邻网络节点-网卡-间的数据传输"><a href="#链路层：相邻网络节点-网卡-间的数据传输" class="headerlink" title="链路层：相邻网络节点[网卡?]间的数据传输"></a>链路层：相邻网络节点[网卡?]间的数据传输</h6><ul>
<li>两个相邻2点的通信，点到点通信，可靠或不可靠      				  ——<strong>点到点</strong></li>
<li>点对点协议PPP，802.11(wifi),Ethernet</li>
<li>传输以帧为单位的数据</li>
<li>总结：在物理层的基础上，在相邻两点间以点对点的形式传输以帧为单位的数据</li>
</ul>
<h6 id="物理层：在线路上传送bit"><a href="#物理层：在线路上传送bit" class="headerlink" title="物理层：在线路上传送bit"></a>物理层：在线路上传送bit</h6><h4 id="ISO-OSI参考模型"><a href="#ISO-OSI参考模型" class="headerlink" title="ISO&#x2F;OSI参考模型"></a>ISO&#x2F;OSI参考模型</h4><p>应用层-<code>表示层-会话层</code>-传输层-网络层-链路层-物理层</p>
<h6 id="表示层"><a href="#表示层" class="headerlink" title="表示层"></a>表示层</h6><ul>
<li>允许应用解释传输的数据，e.g：加密，压缩，机器相关的表示转换</li>
</ul>
<h6 id="会话层："><a href="#会话层：" class="headerlink" title="会话层："></a>会话层：</h6><ul>
<li>数据交换的同步，检查点，恢复</li>
<li>会话管理，维持会话</li>
</ul>
<blockquote>
<p>注意：互联网协议栈没有这两层！</p>
<p>这些服务，如果需要的话，必须被应用实现。在技术栈里面由应用层实现</p>
</blockquote>
<h4 id="各个层次的协议数据单元"><a href="#各个层次的协议数据单元" class="headerlink" title="各个层次的协议数据单元"></a>各个层次的协议数据单元</h4><p>应用层：报文(message)</p>
<p>传输层：报文段(segment)：TCP段，UDP数据报</p>
<p>网络层：分组packet(如果无连接方式：数据报datagram)</p>
<p>数据链路层：帧(frame)</p>
<p>物理层：位(bit)</p>
<hr>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240604171256657.png" alt="image-20240604171256657" style="zoom:50%;" />

<h2 id="2-应用层"><a href="#2-应用层" class="headerlink" title="2.应用层"></a>2.应用层</h2><h3 id="网络应用程序体系架构"><a href="#网络应用程序体系架构" class="headerlink" title="网络应用程序体系架构"></a>网络应用程序体系架构</h3><h5 id="客户-服务器-C-S-体系架构"><a href="#客户-服务器-C-S-体系架构" class="headerlink" title="客户-服务器(C&#x2F;S)体系架构"></a>客户-服务器(C&#x2F;S)体系架构</h5><p>服务器：</p>
<ul>
<li>一直运行</li>
<li>固定的IP地址和周知(默认)的端口号(约定)</li>
<li>扩展性：服务器场<ul>
<li>只依赖数据中心进行扩展</li>
<li>扩展性差，性能成断崖式下降</li>
</ul>
</li>
</ul>
<p>客户端：</p>
<ul>
<li>主动与服务器通信</li>
<li>与互联网有间歇性的连接</li>
<li>可能是动态IP地址</li>
<li>不直接与其他客户端通信</li>
</ul>
<h5 id="对等体-P2P-体系结构"><a href="#对等体-P2P-体系结构" class="headerlink" title="对等体(P2P)体系结构"></a>对等体(P2P)体系结构</h5><ul>
<li>(几乎)没有一直运行的服务器</li>
<li>任意端系统之间可以进行通信</li>
<li>每一个节点即是客户端又是服务端<ul>
<li>自扩展性-新peer节点带来新的服务能力，当然也带来新的服务请求</li>
</ul>
</li>
<li>参与的主机间歇性连接且可以改变IP地址<ul>
<li>难以管理</li>
</ul>
</li>
<li>例子：GnutElla，迅雷</li>
</ul>
<h5 id="C-S和P2Peye-com体系结构的混合体"><a href="#C-S和P2Peye-com体系结构的混合体" class="headerlink" title="C&#x2F;S和P2Peye.com体系结构的混合体"></a>C&#x2F;S和P2Peye.com体系结构的混合体</h5><h6 id="Napster"><a href="#Napster" class="headerlink" title="Napster"></a>Napster</h6><ul>
<li>文件搜索：集合<ul>
<li>主机在中心服务器上注册其资源</li>
<li>主机向中心服务器查询资源位置</li>
</ul>
</li>
<li>文件传输：P2P<ul>
<li>任意Peer节点之间</li>
</ul>
</li>
</ul>
<h6 id="即时通信"><a href="#即时通信" class="headerlink" title="即时通信"></a>即时通信</h6><ul>
<li>在线检测：几种<ul>
<li>当用户上线时，向中心服务器注册其IP地址</li>
<li>用户与中心服务器联系，以找到其在线好友的位置</li>
</ul>
</li>
<li>两个用户之间聊天：P2P</li>
</ul>
<h3 id="进程通信"><a href="#进程通信" class="headerlink" title="进程通信"></a>进程通信</h3><p>进程：在主机上运行的应用程序</p>
<blockquote>
<p>客户端进程：发起通信的进程</p>
<p>服务器进程：等待连接的进程</p>
</blockquote>
<p>在同一个主机内，使用进程间通信机制通信(操作系统定义)</p>
<p>不同主机，通过交换报文(Message)来通信</p>
<ul>
<li>使用OS提供的通信服务</li>
<li>按照应用协议交换报文<ul>
<li>借助传输层提供的服务</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：P2P架构的应用也有客户端进程和服务器进程之分</p>
</blockquote>
<ol>
<li><p>对进程进行编址</p>
<ul>
<li>一个进程：用IP+Port+协议。 例如127.0.0.1:80 TCP</li>
<li>本质上，一对主机进程之间的通信由两个端节点构成</li>
</ul>
</li>
<li><p>传输层提供的服务-层间信息的代表</p>
<ul>
<li><p>如果Socket API每次传输报文，都携带很多信息，太过繁琐不易于管理</p>
</li>
<li><p>用个代号标识通信的双方或单方：socket</p>
</li>
<li><p>TCP Socket：</p>
<ul>
<li>TCP服务，两个进程之间的通信需要之前建立连接<ul>
<li>两个进程通常会持续一段时间，通信关系稳定</li>
</ul>
</li>
<li>可以用一个整数标识两个应用实体时间的通信关系，本地标识</li>
<li>TCP Socket：源IP，源端口，目标IP，目标端口</li>
</ul>
<blockquote>
<p>对于使用面向连接服务(TCP)的应用而言，套接字是4元组的一个具有本地意义的标识</p>
</blockquote>
</li>
<li><p>UDP Socket</p>
<ul>
<li>UDP服务，两个进程之间的通信之前无序建立连接<ul>
<li>每个报文都是独立传输的‘前后报文可能给不同的分布式进程</li>
</ul>
</li>
<li>因此，只能用一个整数表示本应用实体的标识<ul>
<li>因为这个报文可能传给另一个分布式进程</li>
</ul>
</li>
<li>UDP Socket：本IP，本地端口</li>
<li>但是传输报文的时候必须提供对方IP，Port</li>
</ul>
<blockquote>
<p>对于使用无连接服务(UDP)的应用而言，套接字是2元组的一个具有本地意义的标识</p>
</blockquote>
</li>
</ul>
</li>
<li><p>如何使用传输层提供的服务实现应用</p>
<ul>
<li>定义应用层协议：报文格式，解释，时序等</li>
<li>编制程序，通过API调用网络基础设施提供通次你程序传报文，解析报文，实现应用时序等</li>
</ul>
</li>
</ol>
<h5 id="安全TCP——SSL"><a href="#安全TCP——SSL" class="headerlink" title="安全TCP——SSL"></a>安全TCP——SSL</h5><ul>
<li>在TCP上面实现，提供加密的TCP连接</li>
<li>私密性，数据完整性，端到端的鉴别</li>
<li>SSL socket API<ul>
<li>应用通过API将铭文交给socket，SSL将其加密在互联网上传输</li>
<li>详见第八章</li>
</ul>
</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240604193412884.png" alt="image-20240604193412884" style="zoom:33%;" />

<h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><h6 id="HTTP概况"><a href="#HTTP概况" class="headerlink" title="HTTP概况"></a>HTTP概况</h6><p>使用TCP：</p>
<ul>
<li>客户发起一个与服务器的TCP连接(建立套接字)，端口号为80</li>
<li>服务器接收客户的TCP连接</li>
<li>在浏览器(HTTP客户端)与Web服务器(HTTP服务端server)交换HTTP报文</li>
<li>TCP连接关闭</li>
</ul>
<blockquote>
<p>HTTP 是无状态的：服务器并不维护关于客户的任何信息</p>
</blockquote>
<h6 id="HTTP连接"><a href="#HTTP连接" class="headerlink" title="HTTP连接"></a>HTTP连接</h6><p>非持久HTTP</p>
<ul>
<li>最多只有一个对象在TCP连接上发送</li>
<li>下载多个对象需要多个TCP连接</li>
<li>HTTP&#x2F;1.0使用非持久连接</li>
</ul>
<p>持久HTTP</p>
<ul>
<li>多个对象可以在一个(在客户端和服务器之间的)TCP连接上传输</li>
<li>HTTP&#x2F;1.1默认使用持久连接</li>
</ul>
<h6 id="HTTP请求报文"><a href="#HTTP请求报文" class="headerlink" title="HTTP请求报文"></a>HTTP请求报文</h6><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/somdir/page.html</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>www.someschool.edu</span><br><span class="line"><span class="attribute">User-agent</span><span class="punctuation">: </span>Mozilla/4.0</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line">Accept-language:fr</span><br><span class="line">        --最后有一个回车换行符，表示报文结束</span><br></pre></td></tr></table></figure>

<h6 id="HTTP响应报文"><a href="#HTTP响应报文" class="headerlink" title="HTTP响应报文"></a>HTTP响应报文</h6><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Tue, 09 Aug 2011 15:44:04 GMT</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Apache/2.2.3 (CentOS)</span><br><span class="line">Last-Modified:Tue, 09 Aug 2011 15:11:03 GMT</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>6821</span><br><span class="line">Cpntent-Type:text/html</span><br><span class="line"></span><br><span class="line"><span class="language-haskell">(<span class="class"><span class="keyword">data</span>···)</span></span></span><br></pre></td></tr></table></figure>

<h3 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h3><p>​		——控制连接与数据连接分开</p>
<ul>
<li>FTP客户端与FTP服务器通过端 port 21联系，并使用TCP为传输协议</li>
<li>客户端通过控制连接获得身份确认</li>
<li>客户端通过控制连接发送命令浏览远程目录</li>
<li>受到一个文件传输命令时，服务器打开一个到客户端的数据连接(port 20)</li>
<li>一个文件传输完成之后，服务器关闭连接</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240604195448084.png" alt="image-20240604195448084" style="zoom:33%;" />

<h5 id="主动模式"><a href="#主动模式" class="headerlink" title="主动模式"></a>主动模式</h5><ul>
<li>客户端发送 port 命令</li>
<li>服务器根据 port 命令指定的客户端地址和端口号发起数据连接</li>
</ul>
<h5 id="被动模式"><a href="#被动模式" class="headerlink" title="被动模式"></a>被动模式</h5><ul>
<li>客户端发起 PASV 命令</li>
<li>服务器返回监听的地址和端口号</li>
<li>客户端发起数据连接</li>
</ul>
<h3 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h3><p>三个主要组成部分：</p>
<ul>
<li>用户代理</li>
<li>邮件服务器</li>
<li>简单邮件传输协议：SMTP</li>
</ul>
<h6 id="SMTP协议"><a href="#SMTP协议" class="headerlink" title="SMTP协议"></a>SMTP协议</h6><ul>
<li>使用TCP在客户端和服务器之间传送报文，端口号为 <strong>25</strong></li>
<li>直接传输：从发送方服务器到接收方服务器</li>
<li>传输的三个阶段：<ul>
<li>握手</li>
<li>传输报文</li>
<li>关闭</li>
</ul>
</li>
<li>命令&#x2F;响应交互<ul>
<li>命令：ASCII文本</li>
<li>响应：状态码和状态信息</li>
</ul>
</li>
<li><strong>报文必须为7位ASCII码</strong></li>
</ul>
<h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><blockquote>
<p>DNS的主要思路</p>
</blockquote>
<ul>
<li>分层的、基于域的命令规则</li>
<li>若干分布式的数据库完成名字到IP的转换</li>
<li>运行在UDP之上端口号为53的应用服务</li>
<li>核心的Internet功能，但以应用层协议实现<ul>
<li>在网络边缘处理复杂性</li>
</ul>
</li>
</ul>
<blockquote>
<p>DNS记录</p>
</blockquote>
<p>DNS：保存资源记录(RR)的分布式数据库</p>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20231013174016038.png" alt="image-20231013174016038" style="zoom: 33%;" />

<p>TTL：生存时间，决定了资源记录应当从缓存中删除的时间</p>
<ul>
<li>Type &#x3D; A<ul>
<li>Name为主机</li>
<li>Value为IP地址</li>
</ul>
</li>
<li>Type &#x3D; CNAME<ul>
<li>name为规范名字的别名</li>
<li>value为规范名字</li>
</ul>
</li>
<li>Type &#x3D; NS<ul>
<li>name 为域名(如foo.com)</li>
<li>Value 为该域名的权威服务器的域名</li>
</ul>
</li>
<li>Type&#x3D; MX<ul>
<li>Value为那么对应的邮件服务器的名字</li>
</ul>
</li>
</ul>
<blockquote>
<p>DNS大致工作过程</p>
</blockquote>
<ul>
<li>应用调用 解析器(resolver)</li>
<li>解析器作为客户 向Name Server发送查询报文(封装在UDP段中)</li>
<li>Name Server返回相应报文(name&#x2F;ip)</li>
</ul>
<h2 id="3-传输层"><a href="#3-传输层" class="headerlink" title="3.传输层"></a>3.传输层</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li>物理层、数据链路层和网络层共同解决了将主机通过异构网络互联起来所面临的问题。实现了主机到主机的通信。</li>
<li>但实际上在计算机网络中进行通信的真正实体是位于通信两端主机中的进程</li>
<li>如何为运行在不同主机上的应用进程提供直接的通信服务是传输层的任务，传输层协议又称为端到端协议</li>
<li>传输层向高层用户屏蔽了下面网络核心的细节(如网络拓扑、所采用的路由选择协议等)，它使应用进程看见的就好像是两个传输层实体有一条端到端的逻辑通信信道</li>
<li>根据应用需求的不同，因特网的传输层为应用层提供了两种不同的运输协议，即面向连接的TCP和无连接的UDP</li>
</ul>
<h3 id="端口号、复用与分用"><a href="#端口号、复用与分用" class="headerlink" title="端口号、复用与分用"></a>端口号、复用与分用</h3><h4 id="端口号"><a href="#端口号" class="headerlink" title="端口号"></a>端口号</h4><ul>
<li>TCP&#x2F;IP 体系的传输层使用端口号来区分应用层的不同应用进程<ul>
<li>端口号使用 16 比特表示，取值范围为 0-65535<ul>
<li>熟知端口号：<strong>0-1023</strong>，LANA 把这些端口号制定给了 TCP&#x2F;IP 协议中最重要的一些应用程序，例如：FTP使用 21&#x2F;20，HTTP 使用 80，DNS 使用 53</li>
<li>登记端口号：<strong>1024-49151</strong>，为没有熟知的端口号的应用进程使用，需要登记避免重复。例如 Microsoft RDF远程桌面使用 3389</li>
<li>短暂端口号：<strong>49152-65535</strong>，留给客户进程选择暂时使用。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="复用和分用"><a href="#复用和分用" class="headerlink" title="复用和分用"></a>复用和分用</h4><p>运输层端口号、复用与分用：</p>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614212356037.png" alt="image-20240614212356037" style="zoom:33%;" />



<h3 id="TCP-与-UDP"><a href="#TCP-与-UDP" class="headerlink" title="TCP 与 UDP"></a>TCP 与 UDP</h3><h4 id="首部"><a href="#首部" class="headerlink" title="首部"></a>首部</h4><h6 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h6><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614213059106.png" alt="image-20240614213059106" style="zoom: 50%;" />

<h6 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h6><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614213124008.png" alt="image-20240614213124008" style="zoom: 50%;" />

<p>首部结构：</p>
<p><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614215542592.png" alt="image-20240614215542592"></p>
<h4 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h4><ul>
<li>UDP<ul>
<li>无连接</li>
<li>支持一对一，一对多，多对一和多对多交互通信</li>
<li>对应用层交付的报文直接打包</li>
<li>尽最大努力交付，也就是不可靠；不适用流量控制和拥塞控制</li>
<li>首部开销小，仅8字节</li>
</ul>
</li>
<li>TCP<ul>
<li>面向连接</li>
<li>每一条 TCP 连接只能有两个端点 EP，只能是一对一</li>
<li>面向字节流</li>
<li>可靠传输，使用流量控制和拥塞控制</li>
<li>首部最小 20 字节，最大 60字节</li>
</ul>
</li>
</ul>
<h3 id="TCP实现原理"><a href="#TCP实现原理" class="headerlink" title="TCP实现原理"></a>TCP实现原理</h3><h4 id="流量控制"><a href="#流量控制" class="headerlink" title="流量控制"></a>流量控制</h4><p>一般来说，我们总希望数据传输得更快，但是如果发送包把数据发送的过快，接收方可能来不及接受，造成数据的丢失。</p>
<p><strong>流量控制</strong>：让发送方的发送速率不要太快，让接收方来得及接受。</p>
<h5 id="滑动窗口机制"><a href="#滑动窗口机制" class="headerlink" title="滑动窗口机制"></a>滑动窗口机制</h5><ul>
<li>TCP 接收方利用自己的接收窗口大小来限制发送窗口的大小</li>
<li>TCP 发送方收到接收方的零窗口通知后，应启动持续计时器，持续计时器超时后，向接收方发送零窗口探测报文。</li>
</ul>
<h4 id="拥塞控制"><a href="#拥塞控制" class="headerlink" title="拥塞控制"></a>拥塞控制</h4><ol>
<li><strong>慢启动（Slow Start）</strong>：<ul>
<li><strong>目的</strong>：逐步探测网络容量，避免突然增加负载导致拥塞。</li>
<li><strong>过程</strong>：连接初始时，拥塞窗口（cwnd）从一个MSS（最大报文段大小）开始，每收到一个ACK，cwnd增加一个MSS。cwnd呈指数增长，直到达到慢启动阈值（ssthresh）。</li>
</ul>
</li>
<li><strong>拥塞避免（Congestion Avoidance）</strong>：<ul>
<li><strong>目的</strong>：在接近网络容量时，平缓地增加发送速率，避免引发拥塞。</li>
<li><strong>过程</strong>：当cwnd达到ssthresh后，每个RTT（往返时间），cwnd增加一个MSS&#x2F;cwnd。cwnd呈线性增长。</li>
</ul>
</li>
<li><strong>快速重传（Fast Retransmit）</strong>：<ul>
<li><strong>目的</strong>：快速检测和重传丢失的报文段，避免等待超时。</li>
<li><strong>过程</strong>：当收到三个重复ACK时，立即重传丢失的报文段，而不等待重传超时。</li>
</ul>
</li>
<li><strong>快速恢复（Fast Recovery）</strong>：<ul>
<li><strong>目的</strong>：在快速重传后迅速恢复传输速率，避免进入慢启动阶段。</li>
<li><strong>过程</strong>：在快速重传后，将ssthresh设置为cwnd的一半，并将cwnd设置为ssthresh加三个MSS。每收到一个重复ACK，cwnd增加一个MSS；收到新的ACK后，进入拥塞避免阶段。</li>
</ul>
</li>
</ol>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614214233257.png" alt="image-20240614214233257" style="zoom: 67%;" />

<h4 id="三次握手四次挥手"><a href="#三次握手四次挥手" class="headerlink" title="三次握手四次挥手"></a>三次握手四次挥手</h4><h5 id="握手"><a href="#握手" class="headerlink" title="握手"></a>握手</h5><img src="https://img-blog.csdnimg.cn/114bd9b53c554319ae0db15b57b472b8.gif#pic_center" alt="tcp" style="zoom:50%;" />

<p>最终效果：</p>
<ul>
<li>ack &#x3D; seq + 1</li>
<li>最后一次 seq &#x3D; ack</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614215033238.png" alt="image-20240614215033238" style="zoom:33%;" />

<h5 id="挥手"><a href="#挥手" class="headerlink" title="挥手"></a>挥手</h5><img src="https://img-blog.csdnimg.cn/0c17d72769aa4bd2b95bbaee1749b39d.gif#pic_center" alt="挥手"  />

<p>最终效果：</p>
<ul>
<li>ack &#x3D; seq + 1</li>
<li>最后一次 seq &#x3D; ask</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614215054178.png" alt="image-20240614215054178" style="zoom:33%;" />

<h2 id="4-网络层"><a href="#4-网络层" class="headerlink" title="4. 网络层"></a>4. 网络层</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><ul>
<li>网络层的主要任务是实现网络互联，进而实现数据包在各个网络之间的传输。</li>
<li>要实现网络层任务，需要解决以下几个主要问题：<ul>
<li>网络层向传输层提供怎样的服务（”可靠传输”还是”不可靠传输”）</li>
<li>网络层寻址问题</li>
<li>路由选择问题</li>
</ul>
</li>
<li>因特网是目前全世界用户数量最多的互联网，它使用 TCP&#x2F;IP 协议栈</li>
<li>由于 TCP&#x2F;IP 协议栈的网络层使用网络协议 IP ，它是整个协议栈的核心协议，因此在 TCP&#x2F;IP 协议栈中网络层常称为网络层</li>
</ul>
<h4 id="数据平面和控制平面"><a href="#数据平面和控制平面" class="headerlink" title="数据平面和控制平面"></a>数据平面和控制平面</h4><ul>
<li>数据平面<ul>
<li>本地的，每个路由器自身的功能</li>
<li>决定抵达路由器输入端口的数据报如何转发到输出端口</li>
</ul>
</li>
<li>控制平面<ul>
<li>整个网络范围</li>
<li>决定数据报在端到端路径上的路由器之间如何路由</li>
<li>两种数据平面的实现方式<ul>
<li>传统的路由算法：在路由器内实现</li>
<li>软件定义网络(Software-defined networking，SDN)：在远程服务器上实现</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="IPV4"><a href="#IPV4" class="headerlink" title="IPV4"></a>IPV4</h3><h4 id="编址"><a href="#编址" class="headerlink" title="编址"></a>编址</h4><p>IPv4 地址的编址方式经历了如下三个历史阶段：</p>
<ul>
<li>分类编址</li>
<li>划分子网</li>
<li>无分类编址</li>
</ul>
<h5 id="分类编址"><a href="#分类编址" class="headerlink" title="分类编址"></a>分类编址</h5><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240614220017156.png" alt="image-20240614220017156" style="zoom: 33%;" />

<h5 id="划分子网"><a href="#划分子网" class="headerlink" title="划分子网"></a>划分子网</h5><ul>
<li><p>32 比特的子网掩码可以表名分类 IP 地址的主机号被借用了几个比特作为子网号</p>
<ul>
<li>使用连续的比特 1 对应网络号和子网号</li>
<li>使用连续的比特 0 对应主机号</li>
</ul>
</li>
<li><p>给定一个分类的 IP 地址和其相应的子网掩码，就可以知道子网划分的细节：</p>
<ul>
<li><p>划分出的子网数量</p>
</li>
<li><p>每个子网可分配的 IP 地址数量</p>
</li>
<li><p>每个子网的网络地址和广播地址</p>
</li>
<li><p>每个子网可分配的最小和最大地址</p>
</li>
</ul>
</li>
</ul>
<h4 id="数据报发送"><a href="#数据报发送" class="headerlink" title="数据报发送"></a>数据报发送</h4><h5 id="主机发送-IP-数据报"><a href="#主机发送-IP-数据报" class="headerlink" title="主机发送 IP 数据报"></a>主机发送 IP 数据报</h5><p>判断目的主机是否与自己在同一个网络</p>
<ul>
<li>若在同一个网络，则属于直接交付</li>
<li>若不在同一个网络，则属于间接交付，传输给主机所在网络的默认网关(路由器)，由哦默认网关帮忙转发</li>
</ul>
<h5 id="路由器转发-IP-数据报"><a href="#路由器转发-IP-数据报" class="headerlink" title="路由器转发 IP 数据报"></a>路由器转发 IP 数据报</h5><ol>
<li>检查 IP 数据报首部是否出错<ol>
<li>若出错，则直接丢弃该 IP 数据报并通告源主机</li>
<li>若没有出错，则进行转发</li>
</ol>
</li>
<li>根据 IP 数据报的目的地址在路由表中查找匹配的条目<ol>
<li>若找到匹配的条目，则转发给条目中指示的下一条</li>
<li>若找不到，则丢弃该 IP 数据报并通告源主机</li>
</ol>
</li>
</ol>
<h4 id="数据报格式"><a href="#数据报格式" class="headerlink" title="数据报格式"></a>数据报格式</h4><p><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616002021305.png" alt="image-20240616002021305"></p>
<h3 id="路由选择协议"><a href="#路由选择协议" class="headerlink" title="路由选择协议"></a>路由选择协议</h3><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616000314784.png" alt="image-20240616000314784" style="zoom:33%;" />

<h4 id="RIP-路由信息协议"><a href="#RIP-路由信息协议" class="headerlink" title="RIP - 路由信息协议"></a>RIP - 路由信息协议</h4><blockquote>
<p>路由信息协议 RIP(Routing Information Protocol)是内部网关协议 IGP 中最先得到广泛使用的协议之一。</p>
</blockquote>
<ul>
<li>RIP  要求自治系统 AS 内的每一个路由器都要维护从他自己到 AS 内其他每个网络的距离记录</li>
<li>RIP 使用跳数(Hop Count)作为度量来衡量到达目的网络的距离</li>
<li>RIP 认为好的路由就是<strong>距离短</strong>的路由，也就是所谓通过路由器数量最少的路由。</li>
</ul>
<h4 id="OSPF-开放最短路径优先"><a href="#OSPF-开放最短路径优先" class="headerlink" title="OSPF - 开放最短路径优先"></a>OSPF - 开放最短路径优先</h4><blockquote>
<p>开放最短路径优先 OSPF(Open Shortest Path First)，视为克制RIP的缺点在1989年开发出来的。</p>
</blockquote>
<ul>
<li>使用了 Dijkstra 提出的最短路径算法 SPF</li>
<li>OSPF 是基于链路状态的，而不像 RIP 那样是基于距离向量的<ul>
<li>链路状态是指本路由器都和哪些路由器相邻，以及相应链路的”cost”。</li>
</ul>
</li>
<li>OSPF 采用 SPF算法计算路由，在算法上保证了不会产生路由环路</li>
<li>OSPF 不限制网络规模。更新效率高，收敛速度快</li>
</ul>
<h4 id="BGP-边界网关协议"><a href="#BGP-边界网关协议" class="headerlink" title="BGP - 边界网关协议"></a>BGP - 边界网关协议</h4><blockquote>
<p>因特网采用分层次的路由选择协议</p>
</blockquote>
<ul>
<li>内部网关协议 IGP (例如路由信息协议 RIP 或开放最短路径优先 OSPF)<ul>
<li>设法使分组在一个自治系统内尽可能有效地从源网络传输到目的网络</li>
<li>无需考虑自治系统外部其他方面的策略</li>
</ul>
</li>
<li>外部网关协议 EGP (例如边界网关协议 BGP)<ul>
<li>在不同自治系统内，度量路由的”cost”可能不同，因此，对于自治系统之间的路由选择，使用”cost”作为度量是不可行的</li>
</ul>
</li>
</ul>
<h3 id="ICMP-互联网控制消息协议"><a href="#ICMP-互联网控制消息协议" class="headerlink" title="ICMP - 互联网控制消息协议"></a>ICMP - 互联网控制消息协议</h3><blockquote>
<p> ICMP（Internet Control Message Protocol，互联网控制消息协议）是网络层协议，主要用于在网络设备（如路由器、主机）之间传递控制消息和错误报告。它在IP协议中帮助诊断网络问题并提供有关网络通信状态的信息。</p>
</blockquote>
<p>ICMP消息封装在IP包中传输，但它并不用于传输用户数据，而是用于传递控制信息。常见的ICMP消息类型有回显请求（Echo Request）和回显应答（Echo Reply），用于诊断网络连接的工具如 <code>ping</code> 和 <code>traceroute</code> 就是基于这些消息工作的。</p>
<h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><ul>
<li>ping<ul>
<li>ping命令利用ICMP的Echo Request和Echo Reply消息来测试主机之间的连通性和响应时间。</li>
</ul>
</li>
</ul>
<ul>
<li><p>traceroute</p>
<ul>
<li>traceroute工具利用ICMP的时间超过（Time Exceeded）消息来确定数据包在到达目的地之前经过的每一个路由器，帮助诊断网络路径问题。</li>
</ul>
</li>
<li><p>错误报告</p>
<ul>
<li>路由器和主机使用ICMP消息来报告网络错误，如目标不可达、时间超过等，帮助网络管理员快速定位和解决问题。</li>
</ul>
</li>
</ul>
<h3 id="DHCP-动态主机配置协议"><a href="#DHCP-动态主机配置协议" class="headerlink" title="DHCP - 动态主机配置协议"></a>DHCP - 动态主机配置协议</h3><p>DHCP(（Dynamic Host Configuration Protocol)是一种网络管理协议，用于自动为网络中的设备分配IP地址、子网掩码、网关和DNS服务器等网络配置信息。它简化了网络管理员的工作，减少了手动配置的复杂性和错误。</p>
<ul>
<li>DHCP除了IP地址，还可以分配客户的第一跳路由器地址（网关）；DNS服务器的IP地址或域名；子网掩码</li>
<li>DHCP是应用层协议</li>
</ul>
<h3 id="NAT-网络地址转换"><a href="#NAT-网络地址转换" class="headerlink" title="NAT - 网络地址转换"></a>NAT - 网络地址转换</h3><p>NAT(Network Address Translation)是一种在计算机网络中将私有（内部）IP地址映射为公共（外部）IP地址的技术。它由<strong>路由器或防火墙</strong>设备实现，主要用于解决IPv4地址匮乏问题，并提高网络安全性。</p>
<h4 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h4><h4 id="NAT-的类型"><a href="#NAT-的类型" class="headerlink" title="NAT 的类型"></a>NAT 的类型</h4><ul>
<li><p>静态NAT（Static NAT）</p>
<ul>
<li><p>静态NAT为每个内部私有IP地址分配一个唯一的公共IP地址。这种映射是固定的，不会改变。</p>
</li>
<li><p><strong>优点</strong>：适用于需要外界访问内部特定服务器的场景，如Web服务器。</p>
</li>
<li><p><strong>缺点</strong>：需要大量的公共IP地址，扩展性差。</p>
</li>
</ul>
</li>
<li><p>动态NAT（Dynamic NAT）</p>
<ul>
<li><p>动态NAT从一个公共IP地址池中动态地为内部私有IP地址分配公共IP地址。每次内部设备请求外部连接时，NAT设备从池中选取一个公共IP地址进行映射。</p>
</li>
<li><p><strong>优点</strong>：节省公共IP地址。</p>
</li>
<li><p><strong>缺点</strong>：分配的公共IP地址是动态的，外部无法固定访问内部特定设备。</p>
</li>
</ul>
</li>
<li><p>端口地址转换（PAT，Port Address Translation）<strong>，也称为</strong>NAT重载（NAT Overload）</p>
<ul>
<li>PAT是最常用的NAT类型，它允许多个内部私有IP地址共享一个公共IP地址。通过使用不同的端口号来区分不同的内部设备。</li>
<li><strong>优点</strong>：极大地节省了公共IP地址，适用于大多数家庭和小型企业网络。</li>
<li><strong>缺点</strong>：依赖于端口号的唯一性，可能会遇到端口耗尽的问题。</li>
</ul>
</li>
</ul>
<h3 id="SDN-软件定义网络"><a href="#SDN-软件定义网络" class="headerlink" title="SDN - 软件定义网络"></a>SDN - 软件定义网络</h3><blockquote>
<p>软件定义网络（Software-Defined Networking, SDN）是一种网络架构，它通过将网络控制平面和数据平面分离，实现网络的集中控制和灵活管理。SDN的核心思想是将网络设备的控制逻辑从硬件中抽离出来，通过软件进行集中管理和配置。</p>
</blockquote>
<ul>
<li>SDN并不是一个具体的技术，它是一种网络设计理念，规划了网络的各个组成部分（软件、硬件、转发面和控制面）及相互之间的互动关系.</li>
<li>SDN的核心思想是建立一个通用转发体系：每个交换设备上包含一个流表(flow table)；流表由一个逻辑上中心化的控制器来计算和分发</li>
</ul>
<h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><ul>
<li><p>控制与数据平面分离</p>
<ul>
<li>传统网络设备将控制平面和数据平面集成在一起，而 SDN 通过将这两者分离，使得网络设备仅负责数据包的转发，而控制逻辑由集中控制器管理。</li>
</ul>
</li>
<li><p>集中控制</p>
<ul>
<li><p>SDN 控制器维护全局网络视图，能够根据网络状态和策略动态调整网络配置。</p>
</li>
<li><p>控制器通过南向接口协议（如 OpenFlow）向网络设备下发转发规则。</p>
</li>
</ul>
</li>
<li><p>可编程性</p>
<ul>
<li>网络管理员可以通过编写应用程序来定义网络行为和策略，这些应用程序通过北向接口与控制器交互，灵活控制网络流量。</li>
</ul>
</li>
</ul>
<h2 id="5-数据链路层"><a href="#5-数据链路层" class="headerlink" title="5. 数据链路层"></a>5. 数据链路层</h2><h3 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p> 数据链路层的职责是把数据报从一个节点传送到与该节点有直接物理链路相连的另一个节点。</p>
</blockquote>
<p>数据链路：</p>
<ul>
<li>使用点对点信道的数据链路层<ul>
<li>点对点链路：链路两端各一个节点，一个发送一个接收</li>
<li>三个重要问题：<strong>封装成帧</strong>、<strong>差错检测</strong>、<strong>可靠传输</strong>、(流量控制)</li>
</ul>
</li>
<li>使用广播信道的数据链路层<ul>
<li>广播链路：多个节点连接到一个共享的广播信道</li>
<li>解决<strong>多路访问问题</strong>：如何协调多个发送和接受节点之间对共享广播信道的访问；相关技术是<strong>多路访问协议</strong>（也称为多址访问协议）<ul>
<li>频分多路复用、时分多路复用、码分多路复用</li>
<li>共享式以太网的媒体接入控制协议 CSMA&#x2F;CD</li>
<li>802.11 局域网的媒体接入控制协议 CSMA&#x2F;CA</li>
</ul>
</li>
</ul>
</li>
<li>数据链路层的互联设备<ul>
<li>网桥和交换机的工作原理</li>
<li>集线器(物理层互联设备)与交换机</li>
</ul>
</li>
</ul>
<h3 id="封装成帧"><a href="#封装成帧" class="headerlink" title="封装成帧"></a>封装成帧</h3><ul>
<li>封装成帧是指数据链路层给上层交付的协议数据单元添加帧头和帧尾<ul>
<li>包含重要的控制信息</li>
<li>作用之一是帧定界</li>
</ul>
</li>
<li>透明传输是指数据链路层对上层交互的数据没有任何限制<ul>
<li>面向字节的物理链路使用字节填充实现透明传输</li>
<li>面向比特的物理链路使用比特填充的方式实现透明传输</li>
</ul>
</li>
<li>考虑到帧的传输效率和差错控制等，应当使帧的数据部分长度尽可能大，但每一种数据链路层协议规定了帧的数据部分长度上限：最大传送单元 MTU(Maximum Transfer Unit)</li>
</ul>
<h3 id="差错检测"><a href="#差错检测" class="headerlink" title="差错检测"></a>差错检测</h3><ul>
<li>奇偶校验：最基本的方法</li>
<li>Internet校验和：常用于运输层</li>
<li>循环冗余检测：常用于链路层</li>
</ul>
<p>前两个计算量小但是差错检测率不高，一般采用循环冗余检测 CRC 方法</p>
<h4 id="CRC-循环冗余检测"><a href="#CRC-循环冗余检测" class="headerlink" title="CRC - 循环冗余检测"></a>CRC - 循环冗余检测</h4><p>CRC(Cylic Redundancy Check) 即多项式编码，把要发送的比特串看作为是系数为0或1的一个多项式，对比特串的操作看作为多项式。一般在数据链路层，由网络适配器(网卡)实现。</p>
<p>具体步骤如下：</p>
<ol>
<li><strong>数据表示</strong>：<ul>
<li>将待传输的数据视为一个二进制多项式。例如，数据 <code>11010011101100</code> 可以表示为多项式 <code>x^13+x^12+x^10+x^8+x^7+x^6+x^4+x^3+x^2</code></li>
</ul>
</li>
<li><strong>选择生成多项式</strong>：<ul>
<li>选择一个预定义的生成多项式（也称为多项式除数），通常记作 <code>G(x)</code>。例如，一个常用的生成多项式是 CRC-32 中的 <code>G(x)=x^32+x^26+x^23+x^22+x^16+x^12+x^11+x^10+x^8+x^7+x^5+x^4+x^2+x+1</code></li>
</ul>
</li>
<li><strong>数据扩展</strong>：<ul>
<li>将数据多项式<code> D(x)</code>乘以<code> x^n</code>，其中 n 是生成多项式的阶数（即最高幂次）。这相当于在数据后面添加 n 个零。例如，对于一个4位的生成多项式 <code>G(x)</code>，数据 <code>D(x)</code> 会扩展为<code> D(x)⋅x^4</code>。</li>
</ul>
</li>
<li><strong>求余</strong>：<ul>
<li>使用二进制长除法对扩展后的数据 D(x)⋅x^n 除以生成多项式 <code>G(x)</code>，得到余数<code> R(x)</code>。这个余数就是CRC校验码。</li>
</ul>
</li>
<li><strong>附加校验码</strong>：<ul>
<li>将余数 <code>R(x)</code> 附加到原始数据后形成传输数据。</li>
</ul>
</li>
<li><strong>接收方验证</strong>：<ul>
<li>接收方接收到数据后，用相同的生成多项式 G(x) 对接收到的数据多项式进行除法运算。如果余数为零，则认为数据传输无误；否则，数据存在错误</li>
</ul>
</li>
</ol>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616021457439.png" alt="image-20240616021457439" style="zoom:33%;" />

<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616021507807.png" alt="image-20240616021507807" style="zoom:33%;" />



<h3 id="多路访问协议"><a href="#多路访问协议" class="headerlink" title="多路访问协议"></a>多路访问协议</h3><blockquote>
<p> 信道划分协议主要分为三类：<strong>频分多路复用（FDM）</strong>、<strong>时分多路复用（TDM）</strong> 和 <strong>码分多路复用（CDM）</strong>。此外，还有 <strong>随机访问协议</strong> 和 <strong>轮询协议</strong> 等替代方案。</p>
</blockquote>
<h4 id="FDM-频分多路复用"><a href="#FDM-频分多路复用" class="headerlink" title="FDM - 频分多路复用"></a>FDM - 频分多路复用</h4><p><strong>原理</strong>：<br> 频分多路复用将信道的频谱划分为多个频率段，每个频率段分配给不同的节点使用。每个节点在它的频率段内进行通信，不同节点的信号在频率上互不干扰。</p>
<p><strong>特点</strong>：</p>
<ul>
<li>每个节点都有固定的频率带宽。</li>
<li>适用于持续的数据传输。</li>
<li>带宽利用率可能较低，因为频谱是固定分配的，无论节点是否有数据要发送。</li>
</ul>
<p><strong>示例</strong>：<br> 无线电广播中，各个电台使用不同的频率进行广播。</p>
<h4 id="TDM-时分多路复用"><a href="#TDM-时分多路复用" class="headerlink" title="TDM - 时分多路复用"></a>TDM - 时分多路复用</h4><p><strong>原理</strong>：<br> 时分多路复用将时间划分为多个时隙（Time Slots），每个时隙分配给不同的节点使用。每个节点在它的时隙内进行通信，不同节点的信号在时间上互不干扰。</p>
<p><strong>特点</strong>：</p>
<ul>
<li>每个节点都有固定的时间时隙。</li>
<li>适用于连续数据流。</li>
<li>时间利用率可能较低，因为时隙是固定分配的，无论节点是否有数据要发送。</li>
</ul>
<p><strong>示例</strong>：<br> 电话系统中的时分多路复用（TDM）技术。</p>
<h4 id="CDM-码分多路复用"><a href="#CDM-码分多路复用" class="headerlink" title="CDM - 码分多路复用"></a>CDM - 码分多路复用</h4><p><strong>原理</strong>：<br> 码分多路复用使用不同的码序列（Code Sequences）来区分不同的节点。所有节点在同一时间、同一频率上进行通信，但使用不同的码序列。接收端使用相同的码序列来提取特定节点的数据。</p>
<p><strong>工作流程</strong>：</p>
<ol>
<li><strong>数据编码</strong>：每个发送节点将自己的数据与一个独特的<strong>伪随机码</strong>（pseudo-random code）进行编码。这个码通常是比特序列。</li>
<li><strong>信号叠加</strong>：所有编码后的信号在同一频谱上传输，形成一个复合信号。</li>
<li><strong>数据解码</strong>：接收节点使用与发送节点相同的伪随机码对接收到的复合信号进行解码，从中提取出属于自己的数据。</li>
</ol>
<p><strong>特点</strong>：</p>
<ul>
<li>高效利用频谱资源。</li>
<li>能够承受一定的干扰和噪声。</li>
<li>需要复杂的编码和解码技术。</li>
</ul>
<h4 id="CSMA-载波侦听多路访问"><a href="#CSMA-载波侦听多路访问" class="headerlink" title="CSMA - 载波侦听多路访问"></a>CSMA - 载波侦听多路访问</h4><blockquote>
<p>载波监听多路访问（Carrier Sense Multiple Access, CSMA） 是一种用于共享媒体网络的媒体接入控制协议。CSMA 的基本思想是网络节点在传输数据之前首先监听信道（Carrier Sense），只有当信道空闲时才开始传输数据。CSMA 通过这种方式减少数据包碰撞的概率。</p>
</blockquote>
<p><strong>CSMA</strong> 协议在多种网络技术中得到了广泛应用，特别是在早期的局域网和一些无线网络中。具体应用如下：</p>
<ul>
<li><strong>早期以太网（Ethernet）</strong>：以太网（有线）采用 <strong>CSMA&#x2F;CD</strong>（带碰撞检测的 CSMA）协议来管理信道访问。</li>
<li><strong>无线局域网（Wi-Fi）</strong>：无线网络中采用 <strong>CSMA&#x2F;CA</strong>（带碰撞避免的 CSMA）协议。</li>
</ul>
<h5 id="CSMA-CD（带碰撞检测的-CSMA）"><a href="#CSMA-CD（带碰撞检测的-CSMA）" class="headerlink" title="CSMA&#x2F;CD（带碰撞检测的 CSMA）"></a>CSMA&#x2F;CD（带碰撞检测的 CSMA）</h5><ul>
<li><strong>监听信道</strong>：节点在发送数据之前先监听信道是否空闲。</li>
<li><strong>发送数据</strong>：如果信道空闲，节点开始发送数据。如果信道忙，则等待一段时间后重试。</li>
<li><strong>检测碰撞</strong>：在数据发送过程中，节点同时监听信道。如果检测到碰撞（多个节点同时发送导致信号冲突），停止发送数据。</li>
<li><strong>处理碰撞</strong>：检测到碰撞的节点发送一个短的干扰信号（Jam Signal）以通知其他节点发生了碰撞。</li>
<li><strong>重试发送</strong>：节点等待一个随机的退避时间（Backoff Time）后重试发送数据。</li>
</ul>
<h5 id="CSMA-CA（带碰撞避免的-CSMA）"><a href="#CSMA-CA（带碰撞避免的-CSMA）" class="headerlink" title="CSMA&#x2F;CA（带碰撞避免的 CSMA）"></a>CSMA&#x2F;CA（带碰撞避免的 CSMA）</h5><ul>
<li><strong>监听信道</strong>：节点在发送数据之前先监听信道是否空闲。</li>
<li><strong>随机退避</strong>：如果信道空闲，<strong>节点等待一个随机的退避时间以减少碰撞概率</strong>。如果信道忙，节点继续监听直到信道空闲。</li>
<li><strong>发送数据</strong>：节点在退避时间结束后发送数据。</li>
<li><strong>确认接收（ACK）</strong>：接收节点成功接收数据后，发送一个确认帧（ACK）给发送节点。如果发送节点在预定时间内没有收到ACK，则认为数据丢失，重新发送。</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240616024328288.png" alt="image-20240616024328288" style="zoom:50%;" />

<h3 id="ARP-地址解析协议"><a href="#ARP-地址解析协议" class="headerlink" title="ARP - 地址解析协议"></a>ARP - 地址解析协议</h3><blockquote>
<p>地址解析协议（Address Resolution Protocol, ARP） 是一种用于IPv4网络的协议，它负责将IP地址解析为对应的MAC地址，以便在局域网中进行数据传输。ARP 是网络层和数据链路层之间的重要桥梁，确保数据包能够在局域网中正确地找到目标设备。</p>
</blockquote>
<h4 id="工作原理-1"><a href="#工作原理-1" class="headerlink" title="工作原理"></a>工作原理</h4><p>ARP的工作过程可以分为以下几个步骤：</p>
<ul>
<li><p>ARP请求（ARP Request）</p>
<ul>
<li>当一个设备（比如计算机A）需要知道目标设备（比如计算机B）的MAC地址时，它会在网络上广播一个ARP请求。这个请求包含了目标设备的IP地址。</li>
</ul>
</li>
<li><p>ARP请求的广播</p>
<ul>
<li>ARP请求是一个广播帧，即发送到同一局域网内的所有设备。广播MAC地址通常为 <code>FF:FF:FF:FF:FF:FF</code>。</li>
</ul>
</li>
<li><p>ARP响应（ARP Response）</p>
<ul>
<li>网络中的每个设备都会接收到这个ARP请求，但只有目标设备（计算机B）会回应。目标设备会发送一个包含其MAC地址的ARP响应，直接发送给请求设备（计算机A）。</li>
</ul>
</li>
<li><p>更新ARP缓存</p>
<ul>
<li>计算机A在收到ARP响应后，会将目标设备的IP地址和MAC地址映射关系存储在其ARP缓存（ARP Cache）中，以便后续通信使用。</li>
</ul>
</li>
</ul>
<h4 id="消息格式"><a href="#消息格式" class="headerlink" title="消息格式"></a>消息格式</h4><p>ARP消息一般包含以下几个关键字段：</p>
<ul>
<li><strong>硬件类型（Hardware Type）</strong>：通常为以太网（Ethernet），值为1。</li>
<li><strong>协议类型（Protocol Type）</strong>：通常为IPv4，值为0x0800。</li>
<li><strong>硬件地址长度（Hardware Address Length）</strong>：通常为6（MAC地址长度）。</li>
<li><strong>协议地址长度（Protocol Address Length）</strong>：通常为4（IPv4地址长度）。</li>
<li><strong>操作码（Operation Code）</strong>：1表示ARP请求，2表示ARP响应。</li>
<li><strong>发送方硬件地址（Sender Hardware Address）</strong>：发送方的MAC地址。</li>
<li><strong>发送方协议地址（Sender Protocol Address）</strong>：发送方的IP地址。</li>
<li><strong>目标硬件地址（Target Hardware Address）</strong>：目标设备的MAC地址（ARP请求中为空）。</li>
<li><strong>目标协议地址（Target Protocol Address）</strong>：目标设备的IP地址。</li>
</ul>
<h2 id="6-套接字编程"><a href="#6-套接字编程" class="headerlink" title="6. 套接字编程"></a>6. 套接字编程</h2><h3 id="接口协议"><a href="#接口协议" class="headerlink" title="接口协议"></a>接口协议</h3><ul>
<li>TCP&#x2F;IP协议存在于OS中，网络服务通过OS提供</li>
<li>TCP&#x2F;IP要尽量避免让接口使用某一个厂商的OS中特有的特征（而其他厂商没有）</li>
<li>TCP&#x2F;IP和应用程序之间的接口应该不精确指明：<ul>
<li>不规定接口的细节</li>
<li>只建议需要的功能集</li>
<li>允许系统设计者选择有关API的具体实现细节</li>
</ul>
</li>
</ul>
<h3 id="Socket-编程"><a href="#Socket-编程" class="headerlink" title="Socket 编程"></a>Socket 编程</h3><blockquote>
<p> Socket是一个主机本地应用程序所创建的, 为操作系统所控制的接口， Client&#x2F;server模式的通信接口。应用进程通过这个接口,使用传输层提供的服务, 跨网络发送(接收)消息到(从)其他应用进程</p>
</blockquote>
<h4 id="服务器端步骤"><a href="#服务器端步骤" class="headerlink" title="服务器端步骤"></a>服务器端步骤</h4><p>TCP：</p>
<ol>
<li><strong>创建Socket</strong>：调用<code>socket()</code>函数创建一个套接字。</li>
<li><strong>绑定地址</strong>：调用<code>bind()</code>函数将套接字绑定到一个本地地址（IP地址和端口号）。</li>
<li><strong>监听连接</strong>：调用<code>listen()</code>函数使套接字进入监听状态，准备接收客户端的连接请求。</li>
<li><strong>接受连接</strong>：调用<code>accept()</code>函数从队列中取出一个已完成的连接，当没有连接时会阻塞。</li>
<li><strong>数据传输</strong>：通过<code>send()</code>和<code>recv()</code>函数发送和接收数据。</li>
<li><strong>关闭连接</strong>：调用<code>close()</code>函数关闭套接字。</li>
</ol>
<p>UDP：</p>
<ol>
<li><strong>创建Socket</strong>：调用<code>socket()</code>函数创建一个数据报套接字。</li>
<li><strong>绑定地址</strong>：调用<code>bind()</code>函数将套接字绑定到一个本地地址（IP地址和端口号）。</li>
<li><strong>接收数据</strong>：调用<code>recvfrom()</code>函数接收数据，该函数会返回数据和客户端地址。</li>
<li><strong>发送数据</strong>：调用<code>sendto()</code>函数向客户端发送数据。</li>
<li><strong>关闭Socket</strong>：调用<code>close()</code>函数关闭套接字。</li>
</ol>
<h4 id="客户端步骤"><a href="#客户端步骤" class="headerlink" title="客户端步骤"></a>客户端步骤</h4><ol>
<li><strong>创建Socket</strong>：调用<code>socket()</code>函数创建一个套接字。</li>
<li><strong>连接服务器</strong>：调用<code>connect()</code>函数将套接字连接到服务器端的地址。</li>
<li><strong>数据传输</strong>：通过<code>send()</code>和<code>recv()</code>函数发送和接收数据。</li>
<li><strong>关闭连接</strong>：调用<code>close()</code>函数关闭套接字。</li>
</ol>
<h4 id="TCP-编程"><a href="#TCP-编程" class="headerlink" title="TCP 编程"></a>TCP 编程</h4><img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240617101903565.png" alt="image-20240617101903565" style="zoom: 50%;" />

<h6 id="数据结构socketaddr-in"><a href="#数据结构socketaddr-in" class="headerlink" title="数据结构socketaddr_in"></a>数据结构socketaddr_in</h6><blockquote>
<p>ip地址和port捆绑关系的数据结构(标识进程的端节点)</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">socketaddr_in</span>&#123;</span></span><br><span class="line">    <span class="type">short</span> sin_family;  <span class="comment">//地址族</span></span><br><span class="line">    u_short sin_port;  <span class="comment">//port</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> <span class="title">sin_addr</span>;</span>   <span class="comment">//ip地址</span></span><br><span class="line">    <span class="type">char</span> sin_zero[<span class="number">8</span>];   <span class="comment">//对齐</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>域名和IP地址的数据结构</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hostent</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> *h_name;</span><br><span class="line">    <span class="type">char</span> **h_aliases;</span><br><span class="line">    <span class="type">int</span> h_addrtype;</span><br><span class="line">    <span class="type">int</span> h_length;  <span class="comment">//地址长度</span></span><br><span class="line">    <span class="type">char</span> **h_addr_list;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> h_addr h_addr_list[0];</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20231017133434632.png" alt="image-20231017133434632" style="zoom: 18%;" />

<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20231017133540916.png" alt="image-20231017133540916" style="zoom:17%;" />

<h2 id="实验：TCP-编程-五则运算"><a href="#实验：TCP-编程-五则运算" class="headerlink" title="实验：TCP 编程 - 五则运算"></a>实验：TCP 编程 - 五则运算</h2><h4 id="实验要求"><a href="#实验要求" class="headerlink" title="实验要求"></a>实验要求</h4><p><a target="_blank" rel="noopener" href="https://uestc.feishu.cn/wiki/wikcn7KBvz8W5ibZNQ5DPEo97Lg">https://uestc.feishu.cn/wiki/wikcn7KBvz8W5ibZNQ5DPEo97Lg</a></p>
<img src="https://cdn.jsdelivr.net/gh/p5ych2022/IHS@master/img/image-20240617203834409.png" alt="image-20240617203834409" style="zoom:50%;" />

<h4 id="server-端代码"><a href="#server-端代码" class="headerlink" title="server 端代码"></a>server 端代码</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUFFER_SIZE 1024</span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">sig_atomic_t</span> sigint_flag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">psych_handle_sigint</span><span class="params">(<span class="type">int</span> sig)</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[srv] SIGINT is coming!\n&quot;</span>);</span><br><span class="line">    sigint_flag = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">psych_srv_calc</span><span class="params">(<span class="type">int</span> psych_connfd)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> pdu[<span class="number">6</span>];</span><br><span class="line">    <span class="type">int64_t</span> psych_result;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">ssize_t</span> size_read = read(psych_connfd, pdu, <span class="keyword">sizeof</span>(pdu));</span><br><span class="line">        <span class="keyword">if</span> (size_read == <span class="number">0</span>) &#123;  <span class="comment">// 客户端已关闭连接</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (size_read &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;Read error&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">uint32_t</span> op_code = ntohl(pdu[<span class="number">0</span>]);</span><br><span class="line">        <span class="type">int64_t</span> op1 = ((<span class="type">int64_t</span>)ntohl(pdu[<span class="number">1</span>]) &lt;&lt; <span class="number">32</span>) | ntohl(pdu[<span class="number">2</span>]);</span><br><span class="line">        <span class="type">int64_t</span> op2 = ((<span class="type">int64_t</span>)ntohl(pdu[<span class="number">3</span>]) &lt;&lt; <span class="number">32</span>) | ntohl(pdu[<span class="number">4</span>]);</span><br><span class="line">        <span class="type">char</span> *op;</span><br><span class="line">        <span class="keyword">switch</span> (op_code) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000001</span>:  <span class="comment">// ADD</span></span><br><span class="line">                psych_result = op1 + op2;</span><br><span class="line">                op = <span class="string">&quot;+&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000002</span>:  <span class="comment">// SUB</span></span><br><span class="line">                psych_result = op1 - op2;</span><br><span class="line">                op = <span class="string">&quot;-&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000004</span>:  <span class="comment">// MUL</span></span><br><span class="line">                psych_result = op1 * op2;</span><br><span class="line">                op = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000008</span>:  <span class="comment">// DIV</span></span><br><span class="line">                <span class="keyword">if</span> (op2 == <span class="number">0</span>) &#123;</span><br><span class="line">                    psych_result = <span class="number">0</span>;  <span class="comment">// Avoid division by zero</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    psych_result = op1 / op2;</span><br><span class="line">                &#125;</span><br><span class="line">                op = <span class="string">&quot;/&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000010</span>:  <span class="comment">// MOD</span></span><br><span class="line">                <span class="keyword">if</span> (op2 == <span class="number">0</span>) &#123;</span><br><span class="line">                    psych_result = <span class="number">0</span>;  <span class="comment">// Avoid division by zero</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    psych_result = op1 % op2;</span><br><span class="line">                &#125;</span><br><span class="line">                op = <span class="string">&quot;%&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                psych_result = <span class="number">0</span>;  <span class="comment">// Unknown operation</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">uint32_t</span> rep_pdu[<span class="number">2</span>];</span><br><span class="line">        rep_pdu[<span class="number">0</span>] = htonl((<span class="type">uint32_t</span>)(psych_result &gt;&gt; <span class="number">32</span>));  <span class="comment">// 结果高32位</span></span><br><span class="line">        rep_pdu[<span class="number">1</span>] = htonl((<span class="type">uint32_t</span>)psych_result);          <span class="comment">// 结果低32位</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//psych_result = htonl(psych_result);</span></span><br><span class="line">        <span class="type">ssize_t</span> size_write = write(psych_connfd, rep_pdu, <span class="keyword">sizeof</span>(rep_pdu));</span><br><span class="line">        <span class="keyword">if</span> (size_write &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;Write error&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[rqt_res] %ld %s %ld = %ld\n&quot;</span>, op1, op, op2, psych_result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Usage: %s &lt;IP&gt; &lt;Port&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* psych_server_ip = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> psych_server_port = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="type">int</span> psych_listenfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">psych_serv_addr</span>,<span class="title">psych_cli_addr</span>;</span></span><br><span class="line">    <span class="type">socklen_t</span> psych_cli_len = <span class="keyword">sizeof</span>(psych_cli_addr);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(&amp;psych_serv_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(psych_serv_addr));</span><br><span class="line">    psych_serv_addr.sin_family = AF_INET;</span><br><span class="line">    psych_serv_addr.sin_port = htons(psych_server_port);</span><br><span class="line">    inet_pton(AF_INET, psych_server_ip, &amp;psych_serv_addr.sin_addr);</span><br><span class="line"></span><br><span class="line">    bind(psych_listenfd, (<span class="keyword">struct</span> sockaddr *)&amp;psych_serv_addr, <span class="keyword">sizeof</span>(psych_serv_addr));</span><br><span class="line">    listen(psych_listenfd, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[srv] server[%s:%d] is initializing!\n&quot;</span>, psych_server_ip, psych_server_port);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle SIGINT</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sigaction</span> <span class="title">psych_sigIntHandler</span>;</span></span><br><span class="line">    psych_sigIntHandler.sa_flags = <span class="number">0</span>;</span><br><span class="line">    psych_sigIntHandler.sa_handler = psych_handle_sigint;</span><br><span class="line">    sigemptyset(&amp;psych_sigIntHandler.sa_mask);</span><br><span class="line">    sigaction(SIGINT, &amp;psych_sigIntHandler, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> psych_connfd;</span><br><span class="line">    <span class="keyword">while</span>(!sigint_flag) &#123;</span><br><span class="line">        <span class="type">int</span> psych_connfd = accept(psych_listenfd,  (<span class="keyword">struct</span> sockaddr *)&amp;psych_cli_addr, &amp;psych_cli_len);</span><br><span class="line">        <span class="keyword">if</span> (psych_connfd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (errno == EINTR) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;  <span class="comment">// Interrupted by signal, check the flag and possibly continue</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                perror(<span class="string">&quot;Accept failed&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">char</span> psych_client_ip[INET_ADDRSTRLEN];</span><br><span class="line">        inet_ntop(AF_INET, &amp;psych_cli_addr.sin_addr,psych_client_ip, INET_ADDRSTRLEN);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[srv] client[%s:%d] is accepted!\n&quot;</span>, psych_client_ip, ntohs(psych_cli_addr.sin_port));</span><br><span class="line">        psych_srv_calc(psych_connfd);</span><br><span class="line">        close(psych_connfd);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[srv] client[%s:%d] is closed!\n&quot;</span>, psych_client_ip, ntohs(psych_cli_addr.sin_port));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    close(psych_listenfd);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[srv] listenfd is closed!\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[srv] server is going to exit!\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="client-端代码"><a href="#client-端代码" class="headerlink" title="client 端代码"></a>client 端代码</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span>      <span class="comment">// 标准输入输出函数</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span>     <span class="comment">// Unix标准函数定义</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span>     <span class="comment">// 整型数的确切宽度</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span> <span class="comment">// 套接字接口函数</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span> <span class="comment">// 因特网地址结构体</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span>  <span class="comment">// IP地址转换函数</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span>     <span class="comment">// 标准库函数</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span>     <span class="comment">// 字符串处理函数</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span>      <span class="comment">// 错误号定义</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUFFER_SIZE 1024</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> op_codes[] = &#123;<span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000010</span>&#125;; <span class="comment">// +, -, *, /, %</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *op_strings[] = &#123;<span class="string">&quot;ADD&quot;</span>, <span class="string">&quot;SUB&quot;</span>, <span class="string">&quot;MUL&quot;</span>, <span class="string">&quot;DIV&quot;</span>, <span class="string">&quot;MOD&quot;</span>&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *op_1_strings[] = &#123;<span class="string">&quot;+&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;%&quot;</span>&#125;;</span><br><span class="line"><span class="type">char</span> op_1;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the opcode from the operation string</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">psych_get_opcode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *op)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strcmp</span>(op, op_strings[i]) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> op_codes[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the op_1 from the operation string</span></span><br><span class="line"><span class="type">char</span> <span class="title function_">psych_get_op_1</span><span class="params">(<span class="type">uint32_t</span> op_code)</span> &#123;</span><br><span class="line">    <span class="type">char</span> op_1 = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">switch</span> (op_code) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000001</span>:  <span class="comment">// ADD</span></span><br><span class="line">                op_1 = <span class="string">&#x27;+&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000002</span>:  <span class="comment">// SUB</span></span><br><span class="line">                op_1 = <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000004</span>:  <span class="comment">// MUL</span></span><br><span class="line">                op_1 = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000008</span>:  <span class="comment">// DIV</span></span><br><span class="line">                op_1 = <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x00000010</span>:  <span class="comment">// MOD</span></span><br><span class="line">                op_1 = <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//printf(&quot;op_1: %c\n&quot;, op_1);</span></span><br><span class="line">    <span class="keyword">return</span> op_1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">psych_cli_calc</span><span class="params">(<span class="type">int</span> psych_sock)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> line[BUFFER_SIZE];</span><br><span class="line">    <span class="type">uint32_t</span> op_code;</span><br><span class="line">    <span class="type">int64_t</span> op1, op2;</span><br><span class="line">    <span class="type">char</span> op[<span class="number">10</span>], op_1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(fgets(line, BUFFER_SIZE, <span class="built_in">stdin</span>) == <span class="literal">NULL</span>)&#123;</span><br><span class="line">            perror(<span class="string">&quot;Error reading input&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strncmp</span>(line, <span class="string">&quot;EXIT&quot;</span>, <span class="number">4</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[cli] command EXIT received\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Parse the input</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">sscanf</span>(line, <span class="string">&quot;%s %ld %ld&quot;</span>, op, &amp;op1, &amp;op2) != <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Invalid input\n&quot;</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        op_code = psych_get_opcode(op);</span><br><span class="line">        op_1 = psych_get_op_1(op_code);</span><br><span class="line"></span><br><span class="line">        <span class="type">uint32_t</span> pdu[<span class="number">6</span>];</span><br><span class="line">        pdu[<span class="number">0</span>] = htonl(op_code);</span><br><span class="line">        pdu[<span class="number">1</span>] = htonl((<span class="type">uint32_t</span>)(op1 &gt;&gt; <span class="number">32</span>));</span><br><span class="line">        pdu[<span class="number">2</span>] = htonl((<span class="type">uint32_t</span>)op1);</span><br><span class="line">        pdu[<span class="number">3</span>] = htonl((<span class="type">uint32_t</span>)(op2 &gt;&gt; <span class="number">32</span>));</span><br><span class="line">        pdu[<span class="number">4</span>] = htonl((<span class="type">uint32_t</span>)op2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">ssize_t</span> size_write = write(psych_sock, pdu, <span class="keyword">sizeof</span>(pdu));</span><br><span class="line">        <span class="keyword">if</span> (size_write &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;Failed to send data&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">uint32_t</span> rep_pdu[<span class="number">2</span>]; <span class="comment">// 用于接收两个uint32_t组成的数据</span></span><br><span class="line">        <span class="type">int64_t</span> psych_result;</span><br><span class="line"></span><br><span class="line">        <span class="type">ssize_t</span> size_read = read(psych_sock, rep_pdu, <span class="keyword">sizeof</span>(rep_pdu));</span><br><span class="line">        <span class="keyword">if</span> (size_read &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;Failed to receive message&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (size_read != <span class="keyword">sizeof</span>(rep_pdu)) &#123;</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Incomplete data received\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将接收到的两个uint32_t组合成一个int64_t</span></span><br><span class="line">        psych_result = ((<span class="type">int64_t</span>)ntohl(rep_pdu[<span class="number">0</span>]) &lt;&lt; <span class="number">32</span>) | ntohl(rep_pdu[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 假设op1, op_1, op2是已知的变量，这里直接使用</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[rep_rcv] %ld %c %ld = %ld\n&quot;</span>, op1, op_1, op2, psych_result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Usage: %s &lt;ip&gt; &lt;port&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//set the server ip and port</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* psych_server_ip = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> psych_server_port = atoi(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">psych_serv_addr</span>;</span></span><br><span class="line">    <span class="type">int</span> psych_sock = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//create socket</span></span><br><span class="line">    <span class="keyword">if</span>((psych_sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        perror(<span class="string">&quot;socket creation failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//set the server address</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;psych_serv_addr, <span class="string">&#x27;0&#x27;</span>, <span class="keyword">sizeof</span>(psych_serv_addr));</span><br><span class="line">    psych_serv_addr.sin_family = AF_INET;</span><br><span class="line">    psych_serv_addr.sin_port = htons(psych_server_port);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//convert the ip address to binary form</span></span><br><span class="line">    <span class="keyword">if</span>(inet_pton(AF_INET, psych_server_ip, &amp;psych_serv_addr.sin_addr) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\nInvalid address/ Address not supported \n&quot;</span>);</span><br><span class="line">        close(psych_sock);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Connect to the server</span></span><br><span class="line">    <span class="keyword">if</span> (connect(psych_sock, (<span class="keyword">struct</span> sockaddr *)&amp;psych_serv_addr, <span class="keyword">sizeof</span>(psych_serv_addr)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\nConnection Failed \n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Error: %s\n&quot;</span>, strerror(errno));</span><br><span class="line">        close(psych_sock);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[cli] server[%s:%d] is connected!\n&quot;</span>, psych_server_ip, psych_server_port);</span><br><span class="line">    </span><br><span class="line">   <span class="comment">// Business logic</span></span><br><span class="line">    psych_cli_calc(psych_sock);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//close the socket</span></span><br><span class="line">    close(psych_sock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[cli] connfd is closed\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[cli] client os going to exit!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul>
<li>pdu 的编写与字节序转换</li>
<li>sigint 软中断的处理</li>
</ul>
<hr>
<p>注：最后 client 的 pdu 构造还是有点问题，感觉是因为我传的<code>uint32_t[2]</code>，题目要求的是<code>uint64_t</code>，但是不知道为什么 server 也那样传的就没问题。</p>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Article</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%9B%A0%E7%89%B9%E7%BD%91"><span class="toc-number">1.</span> <span class="toc-text">1. 计算机网络与因特网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AFInternet"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 什么是Internet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E8%AE%BE%E5%A4%87"><span class="toc-number">1.1.1.</span> <span class="toc-text">计算设备</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E9%93%BE%E8%B7%AF"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">通信链路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">分组交换机</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="toc-number">1.1.1.2.1.</span> <span class="toc-text">路由器</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">1.1.1.2.2.</span> <span class="toc-text">链路层交换机</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.1.3.</span> <span class="toc-text">服务描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE-1"><span class="toc-number">1.1.4.</span> <span class="toc-text">协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E7%BD%91%E7%BB%9C%E8%BE%B9%E7%BC%98"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 网络边缘</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%BF%9B%E7%A8%8B%E4%B9%8B%E9%97%B4%E9%80%9A%E8%AE%AF%E6%A8%A1%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.2.0.0.1.</span> <span class="toc-text">应用进程之间通讯模式：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BE%B9%E7%BC%98%EF%BC%9A%E9%87%87%E7%94%A8%E7%BD%91%E7%BB%9C%E8%AE%BE%E6%96%BD%E7%9A%84%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.0.0.2.</span> <span class="toc-text">网络边缘：采用网络设施的面向连接服务</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83"><span class="toc-number">1.3.</span> <span class="toc-text">1.3网络核心</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">电路交换</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E5%A4%8D%E7%94%A8"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">电路交换网络中的复用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#FDM"><span class="toc-number">1.3.1.1.1.</span> <span class="toc-text">FDM</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TDM"><span class="toc-number">1.3.1.1.2.</span> <span class="toc-text">TDM</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%80%E9%99%90%E6%80%A7"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">局限性</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2"><span class="toc-number">1.3.2.</span> <span class="toc-text">分组交换</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BD%AC%E5%8F%91%E4%BC%A0%E8%BE%93"><span class="toc-number">1.3.2.0.1.</span> <span class="toc-text">存储转发传输</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB"><span class="toc-number">1.3.3.</span> <span class="toc-text">网络分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4%E6%8E%A5%E5%85%A5%E7%BD%91%E5%92%8C%E7%89%A9%E7%90%86%E5%AA%92%E4%BD%93"><span class="toc-number">1.4.</span> <span class="toc-text">1.4接入网和物理媒体</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5%E7%BD%91%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.4.1.</span> <span class="toc-text">接入网类型和环境</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%B6%E5%BA%AD%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">家庭接入</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#DSL%E5%9B%A0%E7%89%B9%E7%BD%91%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.1.1.</span> <span class="toc-text">DSL因特网接入</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%B5%E7%BC%86%E5%9B%A0%E7%89%B9%E7%BD%91%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.1.2.</span> <span class="toc-text">电缆因特网接入</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%89%E7%BA%A4%E5%88%B0%E6%88%B7%EF%BC%88FTTH%EF%BC%89"><span class="toc-number">1.4.1.1.3.</span> <span class="toc-text">光纤到户（FTTH）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8B%A8%E5%8F%B7%E5%92%8C%E5%8D%AB%E6%98%9F"><span class="toc-number">1.4.1.1.4.</span> <span class="toc-text">拨号和卫星</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">企业接入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B9%BF%E5%9F%9F%E6%97%A0%E7%BA%BF%E6%8E%A5%E5%85%A5"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">广域无线接入</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%AA%92%E4%BD%93"><span class="toc-number">1.4.2.</span> <span class="toc-text">物理媒体</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7%E5%8D%8F%E8%AE%AE%E5%B1%82%E6%AC%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.5.</span> <span class="toc-text">1.7协议层次和服务模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.5.1.</span> <span class="toc-text">协议和服务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E5%8C%96%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E5%8A%9F%E8%83%BD%EF%BC%9A"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">层次化方式实现复杂网络功能：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE%E7%82%B9"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">服务和服务访问点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E6%A0%88"><span class="toc-number">1.5.2.</span> <span class="toc-text">协议栈</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9A%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8"><span class="toc-number">1.5.2.0.1.</span> <span class="toc-text">应用层：网络应用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%9A%E4%B8%BB%E6%9C%BA%E4%B9%8B%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="toc-number">1.5.2.0.2.</span> <span class="toc-text">传输层：主机之间的数据传输</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9A%E4%B8%BA%E6%95%B0%E6%8D%AE%E6%8A%A5%E4%BB%8E%E6%BA%90%E5%88%B0%E7%9B%AE%E7%9A%84%E7%9A%84%E9%80%89%E6%8B%A9%E8%B7%AF%E7%94%B1"><span class="toc-number">1.5.2.0.3.</span> <span class="toc-text">网络层：为数据报从源到目的的选择路由</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%9A%E7%9B%B8%E9%82%BB%E7%BD%91%E7%BB%9C%E8%8A%82%E7%82%B9-%E7%BD%91%E5%8D%A1-%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="toc-number">1.5.2.0.4.</span> <span class="toc-text">链路层：相邻网络节点[网卡?]间的数据传输</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82%EF%BC%9A%E5%9C%A8%E7%BA%BF%E8%B7%AF%E4%B8%8A%E4%BC%A0%E9%80%81bit"><span class="toc-number">1.5.2.0.5.</span> <span class="toc-text">物理层：在线路上传送bit</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ISO-OSI%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.5.3.</span> <span class="toc-text">ISO&#x2F;OSI参考模型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%A1%A8%E7%A4%BA%E5%B1%82"><span class="toc-number">1.5.3.0.1.</span> <span class="toc-text">表示层</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%9A%E8%AF%9D%E5%B1%82%EF%BC%9A"><span class="toc-number">1.5.3.0.2.</span> <span class="toc-text">会话层：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%84%E4%B8%AA%E5%B1%82%E6%AC%A1%E7%9A%84%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83"><span class="toc-number">1.5.4.</span> <span class="toc-text">各个层次的协议数据单元</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">2.</span> <span class="toc-text">2.应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84"><span class="toc-number">2.1.</span> <span class="toc-text">网络应用程序体系架构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7-%E6%9C%8D%E5%8A%A1%E5%99%A8-C-S-%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">客户-服务器(C&#x2F;S)体系架构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%B9%E7%AD%89%E4%BD%93-P2P-%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.0.2.</span> <span class="toc-text">对等体(P2P)体系结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C-S%E5%92%8CP2Peye-com%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E7%9A%84%E6%B7%B7%E5%90%88%E4%BD%93"><span class="toc-number">2.1.0.3.</span> <span class="toc-text">C&#x2F;S和P2Peye.com体系结构的混合体</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Napster"><span class="toc-number">2.1.0.3.1.</span> <span class="toc-text">Napster</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8D%B3%E6%97%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">2.1.0.3.2.</span> <span class="toc-text">即时通信</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1"><span class="toc-number">2.2.</span> <span class="toc-text">进程通信</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E5%85%A8TCP%E2%80%94%E2%80%94SSL"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">安全TCP——SSL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP"><span class="toc-number">2.3.</span> <span class="toc-text">HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E6%A6%82%E5%86%B5"><span class="toc-number">2.3.0.0.1.</span> <span class="toc-text">HTTP概况</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.3.0.0.2.</span> <span class="toc-text">HTTP连接</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87"><span class="toc-number">2.3.0.0.3.</span> <span class="toc-text">HTTP请求报文</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87"><span class="toc-number">2.3.0.0.4.</span> <span class="toc-text">HTTP响应报文</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FTP"><span class="toc-number">2.4.</span> <span class="toc-text">FTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.4.0.1.</span> <span class="toc-text">主动模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A2%AB%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.4.0.2.</span> <span class="toc-text">被动模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SMTP"><span class="toc-number">2.5.</span> <span class="toc-text">SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#SMTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.5.0.0.1.</span> <span class="toc-text">SMTP协议</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS"><span class="toc-number">2.6.</span> <span class="toc-text">DNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="toc-number">3.</span> <span class="toc-text">3.传输层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">3.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%8F%B7%E3%80%81%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%88%86%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">端口号、复用与分用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">3.2.1.</span> <span class="toc-text">端口号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E7%94%A8%E5%92%8C%E5%88%86%E7%94%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">复用和分用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-%E4%B8%8E-UDP"><span class="toc-number">3.3.</span> <span class="toc-text">TCP 与 UDP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E9%83%A8"><span class="toc-number">3.3.1.</span> <span class="toc-text">首部</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#UDP"><span class="toc-number">3.3.1.0.1.</span> <span class="toc-text">UDP</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TCP"><span class="toc-number">3.3.1.0.2.</span> <span class="toc-text">TCP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94"><span class="toc-number">3.3.2.</span> <span class="toc-text">对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">3.4.</span> <span class="toc-text">TCP实现原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">3.4.1.</span> <span class="toc-text">流量控制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E6%9C%BA%E5%88%B6"><span class="toc-number">3.4.1.1.</span> <span class="toc-text">滑动窗口机制</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6"><span class="toc-number">3.4.2.</span> <span class="toc-text">拥塞控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B"><span class="toc-number">3.4.3.</span> <span class="toc-text">三次握手四次挥手</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8F%A1%E6%89%8B"><span class="toc-number">3.4.3.1.</span> <span class="toc-text">握手</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%A5%E6%89%8B"><span class="toc-number">3.4.3.2.</span> <span class="toc-text">挥手</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">4.</span> <span class="toc-text">4. 网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">4.1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2%E5%92%8C%E6%8E%A7%E5%88%B6%E5%B9%B3%E9%9D%A2"><span class="toc-number">4.1.1.</span> <span class="toc-text">数据平面和控制平面</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPV4"><span class="toc-number">4.2.</span> <span class="toc-text">IPV4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%9D%80"><span class="toc-number">4.2.1.</span> <span class="toc-text">编址</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">分类编址</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">划分子网</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8F%91%E9%80%81"><span class="toc-number">4.2.2.</span> <span class="toc-text">数据报发送</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%8F%91%E9%80%81-IP-%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">主机发送 IP 数据报</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E8%BD%AC%E5%8F%91-IP-%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">路由器转发 IP 数据报</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.2.3.</span> <span class="toc-text">数据报格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.</span> <span class="toc-text">路由选择协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RIP-%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.1.</span> <span class="toc-text">RIP - 路由信息协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OSPF-%E5%BC%80%E6%94%BE%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88"><span class="toc-number">4.3.2.</span> <span class="toc-text">OSPF - 开放最短路径优先</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BGP-%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.3.</span> <span class="toc-text">BGP - 边界网关协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP-%E4%BA%92%E8%81%94%E7%BD%91%E6%8E%A7%E5%88%B6%E6%B6%88%E6%81%AF%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.4.</span> <span class="toc-text">ICMP - 互联网控制消息协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">4.4.1.</span> <span class="toc-text">应用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DHCP-%E5%8A%A8%E6%80%81%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.5.</span> <span class="toc-text">DHCP - 动态主机配置协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NAT-%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">4.6.</span> <span class="toc-text">NAT - 网络地址转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.6.1.</span> <span class="toc-text">类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NAT-%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.6.2.</span> <span class="toc-text">NAT 的类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SDN-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="toc-number">4.7.</span> <span class="toc-text">SDN - 软件定义网络</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.7.1.</span> <span class="toc-text">工作原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">5.</span> <span class="toc-text">5. 数据链路层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">5.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E6%88%90%E5%B8%A7"><span class="toc-number">5.2.</span> <span class="toc-text">封装成帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B"><span class="toc-number">5.3.</span> <span class="toc-text">差错检测</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CRC-%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A3%80%E6%B5%8B"><span class="toc-number">5.3.1.</span> <span class="toc-text">CRC - 循环冗余检测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.4.</span> <span class="toc-text">多路访问协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#FDM-%E9%A2%91%E5%88%86%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">5.4.1.</span> <span class="toc-text">FDM - 频分多路复用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TDM-%E6%97%B6%E5%88%86%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">5.4.2.</span> <span class="toc-text">TDM - 时分多路复用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CDM-%E7%A0%81%E5%88%86%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">5.4.3.</span> <span class="toc-text">CDM - 码分多路复用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSMA-%E8%BD%BD%E6%B3%A2%E4%BE%A6%E5%90%AC%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE"><span class="toc-number">5.4.4.</span> <span class="toc-text">CSMA - 载波侦听多路访问</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CD%EF%BC%88%E5%B8%A6%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B%E7%9A%84-CSMA%EF%BC%89"><span class="toc-number">5.4.4.1.</span> <span class="toc-text">CSMA&#x2F;CD（带碰撞检测的 CSMA）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CA%EF%BC%88%E5%B8%A6%E7%A2%B0%E6%92%9E%E9%81%BF%E5%85%8D%E7%9A%84-CSMA%EF%BC%89"><span class="toc-number">5.4.4.2.</span> <span class="toc-text">CSMA&#x2F;CA（带碰撞避免的 CSMA）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ARP-%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.5.</span> <span class="toc-text">ARP - 地址解析协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86-1"><span class="toc-number">5.5.1.</span> <span class="toc-text">工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.5.2.</span> <span class="toc-text">消息格式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%BC%96%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text">6. 套接字编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%8D%8F%E8%AE%AE"><span class="toc-number">6.1.</span> <span class="toc-text">接口协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Socket-%E7%BC%96%E7%A8%8B"><span class="toc-number">6.2.</span> <span class="toc-text">Socket 编程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.2.1.</span> <span class="toc-text">服务器端步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.2.2.</span> <span class="toc-text">客户端步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TCP-%E7%BC%96%E7%A8%8B"><span class="toc-number">6.2.3.</span> <span class="toc-text">TCP 编程</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84socketaddr-in"><span class="toc-number">6.2.3.0.1.</span> <span class="toc-text">数据结构socketaddr_in</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%EF%BC%9ATCP-%E7%BC%96%E7%A8%8B-%E4%BA%94%E5%88%99%E8%BF%90%E7%AE%97"><span class="toc-number">7.</span> <span class="toc-text">实验：TCP 编程 - 五则运算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="toc-number">7.0.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#server-%E7%AB%AF%E4%BB%A3%E7%A0%81"><span class="toc-number">7.0.2.</span> <span class="toc-text">server 端代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#client-%E7%AB%AF%E4%BB%A3%E7%A0%81"><span class="toc-number">7.0.3.</span> <span class="toc-text">client 端代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">7.0.4.</span> <span class="toc-text">注意事项</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&text=计算机网络"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&is_video=false&description=计算机网络"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=计算机网络&body=Check out this article: http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&title=计算机网络"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&name=计算机网络&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://p5ych2022.github.io/2024/06/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/&t=计算机网络"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2025
    psych
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Article</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
    </ul>
    <ul>
      
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_site_pv">
            本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv" style='display:none'>
                本站访客数<span id="busuanzi_value_site_uv"></span>人
        </span>
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      
    </ul>
  </nav>
</div>

</footer>
    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'p5ych2022/psych.green';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'Comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
